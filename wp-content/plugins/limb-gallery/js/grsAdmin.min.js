var grsActiveCont,grsApp=angular.module("grsApp",[]);grsApp.service("GrsAdminService",["$window","$log","$sce",function(e,r,o){this.mode="pro",this.uploaderUrl=grsUploaderUrl,this.wpUploaderUrl=grsWpUploaderUrl,this.pluginUrl=grsPluginUrl,this.pluginVer=grsPluginVer,this.imagesDir=this.pluginUrl+"/images/",this.getViewsTemplateUrl=function(e){return o.trustAsResourceUrl(this.pluginUrl+"/admin/views/"+e+".html?ver="+this.pluginVer)},this.setTooltip=function(){jQuery(".grsGallFCont").tooltip({position:{my:"center bottom-6",at:"center top",using:function(e,r){jQuery(this).css(e),jQuery("<div>").addClass("arrow").appendTo(this).addClass(r.vertical).addClass(r.horizontal)}},show:{effect:"fadeIn",duration:20},hide:{effect:"fadeOut",duration:20}})},this.getWPImageSizes=function(e){var r=parseInt(e.width),o=parseInt(e.height),t=e.wp_sizes;if(null===t)return{medium:300<r||300<o?this.getRightSizeUrlForWp(300,r,o):"",large:1024<r||1024<o?this.getRightSizeUrlForWp(1024,r,o):"",full:""};e.wp_sizes="object"!=typeof t?JSON.parse(t):t;var a=void 0!==(t=e.wp_sizes).large?"-"+t.large.width+"x"+t.large.height:"";return{medium:void 0!==t.medium?"-"+t.medium.width+"x"+t.medium.height:a,large:a,full:""}},this.getRightSizeUrlForWp=function(e,r,o){return o<r?"-"+e+"x"+Math.round(e*o/r):"-"+Math.round(e*r/o)+"x"+e},this.getItemSrc=function(e){return this["itemSource_"+e.embed](e)},this.itemSource_=function(e){return this.uploaderUrl+e.path+"thumbnail/"+e.name+e.type},this.itemSource_wp=function(e){var r=this.getWPImageSizes(e);return this.wpUploaderUrl+e.path+e.name+r.medium+e.type},this.itemSource_instagram=function(e){return e.thumb_url},this.itemSource_youtube=function(e){return e.thumb_url},this.itemSource_vimeo=function(e){return e.thumb_url},this.itemSource_flickr=function(e){return e.thumb_url},this.log=function(e){"dev"==this.mode&&r.log(e)},this.getTrans=function(e){return void 0!==adminTransObj[e]?adminTransObj[e]:e}}]),grsApp.factory("GrsAdminFactory",["$http","$q","GrsAdminService",function(a,n,e){return{embedMedia:function(e,r,o){var t={action:"grsGalleryAjax",grsAction:"embedMedia",grsAjaxNonce:grsAjaxNonce,provider:e,url:r,gallery:o};return a({method:"POST",url:grsAdminAjax,data:jQuery.param(t),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(e){return n.resolve(e)},function(e){return GrsService.log("errr"),n.reject(e)})},saveGall:function(e,r){var o=0==e.id?"insert":"update",t={action:"grsGalleryAjax",grsAction:o,grsGallid:e.id,title:e.title,description:e.description,grsImages:JSON.stringify(r),grsAjaxNonce:grsAjaxNonce};return a({method:"POST",url:grsAdminAjax,data:jQuery.param(t),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(e){return e.grsAction=o,n.resolve(e)},function(e){return GrsService.log("errr"),n.reject(e)})},saveOrder:function(e,r){var o={action:"grsGalleryAjax",grsAction:"saveOrder",grsAjaxNonce:grsAjaxNonce,gallery:e,items:r};return a({method:"POST",url:grsAdminAjax,data:jQuery.param(o),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(e){return n.resolve(e)},function(e){return GrsService.log("errr"),n.reject(e)})}}}]),grsApp.directive("toInt",function(){return{require:"ngModel",link:function(e,r,o,t){t.$parsers.push(function(e){return""+e}),t.$formatters.push(function(e){return parseInt(e)})}}}),grsApp.directive("validLink",["GrsAdminService",function(t){return{scope:{validLink:"="},link:function(e,r,o){e.link_=function(){return""==e.validLink.link?t.uploaderUrl+e.validLink.path+e.validLink.name+e.validLink.type:e.validLink.link},e.link_wp=function(){return""==e.validLink.link?t.wpUploaderUrl+e.validLink.path+e.validLink.name+e.validLink.type:e.validLink.link},e.link_youtube=function(){return""==e.validLink.link?e.validLink.path:e.validLink.link},e.link_instagram=function(){return e.link_youtube()},e.link_flickr=function(){return e.link_youtube()},e.link_vimeo=function(){return e.link_youtube()},e.validLink.link=e["link_"+e.validLink.embed]()}}}]),grsApp.directive("winclick",["$window",function(e){return{link:function(r){angular.element(e).on("click",function(e){r.$broadcast("winclick::winclick")})}}}]),grsApp.directive("draggable",["GrsAdminService",function(e){return{link:function(o,e){jQuery(e).sortable({start:function(e,r){e.stopPropagation(),o.oldPos=r.item.index(),r.item.addClass("forDrag")},stop:function(e,r){o.newPos=r.item.index(),r.item.removeClass("forDrag"),o.saveOrder(o.oldPos,o.newPos),o.$apply()},placeholder:"grsGallCoGaImC forDrop",delay:100,revert:400,tolerance:"pointer"}).disableSelection()}}}]),grsApp.controller("grsContent",["$scope","$filter","$log","$window","GrsAdminService",function(r,e,o,t,a){r.show=!1,r.showContPart="",r.config=grsConfig,r.grsSave=function(){void 0!==r["save"+r.showContPart]?r["save"+r.showContPart]():a.log("There is no method matching that name - save"+r.showContPart)},r.shThemes=function(e){return r.config.themes}}]),grsApp.directive("extSrc",["GrsAdminService",function(e){return{restrict:"A",scope:!0,link:function(e,r,o){var t=o.extSrc;t=t.replace(/'/g,"\\'"),r.attr("src",t)}}}]),grsApp.directive("grsPopup",["$filter","$http","$log","$timeout","GrsAdminService",function(e,n,r,o,t){return{restrict:"E",transclude:!0,scope:!1,templateUrl:t.getViewsTemplateUrl("grsPopup"),link:function(a,e,r){a.closePopup=function(){a.popupOptions.show=!1,a.popupOptions.showImg=!1,a.popupOptions.content={},a.popupOptions.comments=[]},a.isImage=function(){var e=a.popupOptions.content;return"video"!==e.type&&"link"!==e.type},a.isVideo=function(){return"video"===a.popupOptions.content.type},a.isLink=function(){return"link"===a.popupOptions.content.type},a.imgSrc=function(){var e=a.popupOptions.content;return""===e.embed?t.uploaderUrl+e.path+"/medium/"+e.name+e.type:"wp"===e.embed?t.wpUploaderUrl+e.path+e.name+t.getWPImageSizes(e).large+e.type:e.path},a.itemSrc=function(){return a.popupOptions.content.path},a.imgLoaded=function(e){a.popupOptions.showImg=!0},a.loadComments=function(e,r){var o={action:"grsGalleryAjax",grsAction:"showComments",id:e,gallId:r};n({method:"POST",url:grsAdminAjax,data:jQuery.param(o),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(e){var r=e.data;void 0===r.error&&(a.popupOptions.comments=r.success)},function(e){return GrsService.log("errr"),$q.reject(e)})},a.removeComments=function(o){var t=angular.element(jQuery(".grsGallHeader")).scope();if(t.grsLoading)t.wmassage();else{var e={action:"grsGalleryAjax",grsAction:"removeComments",id:a.popupOptions.comments[o].id};t.grsLoading=!0,n({method:"POST",url:grsAdminAjax,data:jQuery.param(e),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(e){t.grsLoading=!1;var r=e.data;angular.isUndefined(r.error)&&a.popupOptions.comments.splice(o,1)},function(e){return GrsService.log("errr"),$q.reject(e)})}},a.getTrans=t.getTrans}}}]),grsApp.directive("imageOnload",function(){return{restrict:"A",link:function(e,r,o){r.bind("load",function(){e.$apply(o.imageOnload)})}}}),grsApp.directive("grsGalleries",["$filter","$http","$log","$timeout","GrsAdminService","GrsAdminFactory",function(a,g,e,s,c,n){return{restrict:"E",transclude:!0,scope:!1,templateUrl:c.getViewsTemplateUrl("grsGalleries"),link:function(f,e,r){f.filteredItems=[],f.groupedItems=[],f.pageSize=8,f.itemsPerPage=f.pageSize,f.pagedItems=[],f.currentPage=0,f.order="order",f.reverse=!1,f.selGall={},f.items=[],f.embed={show:!1,type:"",url:"",examples:{instagram:["https://www.instagram.com/p/BIvjQDKAp-F"],youtube:["https://www.youtube.com/watch?v=Zi0RpNSELas"],vimeo:["https://vimeo.com/9058605"],flickr:["https://www.flickr.com/photos/luc-mechelen/23071249392"]}},f.saveOrder=function(e,r){var o=f.pageSize*f.currentPage+e,t=f.pageSize*f.currentPage+r,a=[];if(t<o)angular.forEach(f.items,function(e,r){e.order=t<=r&&r<o?r+1:r==o?(e.select=!1,t):r,a.push({id:e.id,order:e.order})}),f.itemsOrderToChange=a;else{if(!(o<t))return;angular.forEach(f.items,function(e,r){e.order=o<r&&r<=t?r-1:r==o?(e.select=!1,t):r,a.push({id:e.id,order:e.order})}),f.itemsOrderToChange=a}f.orderBy("order")},f.saveOrderDB=function(e){var r=angular.element(jQuery(".grsGallHeader")).scope();r.grsLoading?r.wmassage():(r.grsLoading=!0,n.saveOrder(f.selGall.id,e).then(function(e){r.grsLoading=!1,void 0===e.data.error?(r.grsMassage=f.getTrans("text_041"),r.grsMassageMood="success"):(r.grsMassage=e.data.error,r.grsMassageMood="error"),r.massage()},function(e){c.log(e)}))},f.getMinOrder=function(){return 0<f.items.length?Math.min.apply(Math,f.items.map(function(e){return e.order})):1},f.popupOptions={show:!1,content:{}},f.showPopup=function(e,r){r.stopPropagation(),r.preventDefault(),angular.element(jQuery(".grsGallHeader")).scope().showGTs=!1,f.popupOptions.show=!0,f.popupOptions.content=f.pagedItems[f.currentPage][e],f.loadComments(f.pagedItems[f.currentPage][e].id,f.selGall.id)},f.getItemSrc=function(e){var r=f.pagedItems[f.currentPage][e];return c.getItemSrc(r)},f.getGallItems=function(){var t=angular.element(jQuery(".grsGallHeader")).scope(),e={action:"grsGalleryAjax",grsAction:"getGalleryItems",grsAjaxNonce:grsAjaxNonce};t.grsLoading=!0,g({method:"POST",url:grsAdminAjax,data:jQuery.param(e),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(e){t.grsLoading=!1;var r=e.data;if(t.galleriesDataIsLoaded=!0,f.$$phase||f.$apply(),angular.isUndefined(r.error)){var o=r.success;o=a("filter")(o,function(e){return e.id=parseInt(e.id),!0}),f.galleriesData=a("orderBy")(o,"id",!0)}else t.grsMassage="text_074",t.grsMassageMood="error",t.massage()},function(e){return c.log("errr"),t.grsLoading=!1,t.grsMassage="text_074",t.grsMassageMood="error",t.massage(!1),$q.reject(e)})},f.getGallItems(),String.prototype.trunc=String.prototype.trunc||function(e){return this.length>e?this.substr(0,e-1)+" ...":this.toString()},f.changeGallery=function(e,r){if(c.log("gallery (to change id)"),c.log(e),c.log(r),0==e)return f.selGall={id:0,title:"",description:"",pvIm:c.imagesDir+"thumbnail/grsnopv.png",imagesCount:0,images:[],prevImgPath:"",prevImgName:"grsnopv",prevImgType:".png"},f.items=[],void f.search();if(0==f.selGall.id&&(f.selGall.id=e,f.selGall.title=r,f.galleriesData.splice(0,0,f.selGall),f.galleriesData=angular.copy(f.galleriesData)),!angular.isUndefined(f.galleriesData)){for(var o=0;o<f.galleriesData.length;o++)if(f.galleriesData[o].id==e){f.selGall=f.galleriesData[o],f.selGall.pvIm=("grsnopv"===f.selGall.prevImgName?c.imagesDir:c.uploaderUrl)+f.selGall.prevImgPath+"thumbnail/"+f.selGall.prevImgName+f.selGall.prevImgType,f.items=f.selGall.images,angular.isUndefined(f.itemsOrderToChange)||delete f.itemsOrderToChange;break}f.search()}},f.saveGall=function(){var o=angular.element(jQuery(".grsGallHeader")).scope();o.grsLoading?o.wmassage():(o.grsLoading=!0,n.saveGall(f.selGall,f.pagedItems[f.currentPage]).then(function(e){if(o.grsLoading=!1,void 0===e.data.error){var r=e.data.success;"insert"===e.grsAction?(f.changeGallery(r.id,r.title),o.addItem(r.title,"",r.id)):(f.selGall.title=r.title,o.updateItem(r.title),f.updateAlbsContents(r.id,r.title,"gal")),f.galleriesData=angular.copy(f.galleriesData),o.grsMassage=f.getTrans("text_042"),o.grsMassageMood="success",void 0!==f.itemsOrderToChange&&(f.saveOrderDB(f.itemsOrderToChange),delete f.itemsOrderToChange)}else o.grsMassage=""==e.data.error?f.getTrans("text_043"):e.data.error,o.grsMassageMood="error";o.massage()},function(e){c.log(e)}))},f.enableWPMedia=function(){f.addImagesFromWPMedia=wp.media.frames.file_frame=wp.media({title:"Add image to gallery",button:{text:"Add"},multiple:"add",toolbar:"select",library:{type:"image"}}),f.addImagesFromWPMedia.on("select",function(){var e=f.addImagesFromWPMedia.state().get("selection"),r=[];e.map(function(e){r.push(e.toJSON())}),f.callbackForWPMediaAddImages(r)})},f.enableWPMedia(),f.callbackForWPMediaAddImages=function(e){var a=angular.element(jQuery(".grsGallHeader")).scope();if(a.grsLoading)a.wmassage();else{c.log(e);var s=f.getMinOrder(),i=f.selGall.imagesCount?parseInt(f.selGall.imagesCount):0,l=[];angular.forEach(e,function(e){i++,s--,c.log(e);var r=e.filename.split("."),o="."+r.pop(),t=e.url.split(c.wpUploaderUrl)[1].split(e.filename),a=f.getWpImageSizesJSON(e.sizes,e.width,e.height);r.splice(r.length);var n={name:r.join("."),title:e.title,description:e.description,path:t[0],type:o,order:s,key:i,width:e.width,height:e.height,wp_sizes:a};c.log(n),l.push(n)}),c.log(l),f.selGall.imagesCount=i;var r={action:"grsGalleryAjax",grsAction:"addImagesFromWP",grsId:f.selGall.id,files:l,grsAjaxNonce:grsAjaxNonce};a.grsLoading=!0,g({method:"POST",url:grsAdminAjax,data:jQuery.param(r),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(e){c.log(e);var r=e.data;if(a.grsLoading=!1,"success"===Object.keys(r)[0]){a.grsMassage=f.getTrans("text_044");for(var o=r.success,t=0;t<l.length;t++)c.log("id - "+o[t]),f.addItem(l[t].name,l[t].title,l[t].description,l[t].path,"",s,l[t].type,"wp","",l[t].key,o[t],l[t].width,l[t].height,l[t].wp_sizes);a.grsMassageMood="success"}else a.grsMassage=r.error,a.grsMassageMood="error";a.massage()},function(e){return c.log("errr"),$q.reject(e)})}},f.getWpImageSizesJSON=function(o,e,r){var t={};function a(e){t[e]={};var r=o[e].url.split("-").pop().split(".")[0].split("x");t[e].width=r[0],t[e].height=r[1]}return t.full={width:e,height:r},angular.isUndefined(o.thumbnail)||a("thumbnail"),angular.isUndefined(o.medium)||a("medium"),angular.isUndefined(o.large)||a("large"),t},f.addImagesFromWP=function(){f.addImagesFromWPMedia.open()},f.addImages=function(){var e=angular.element(jQuery(".grsGallUpl")).scope(),r=angular.element(jQuery(".grsGallHeader")).scope();e.options.show||r.selectTab("Upl"),e.options.addImages||(e.options.addAction="addImages",e.options.addImages=!0,e.options.addImageTitle="Add")},f.addGPvIm=function(e,r,o){f.selGall.prevImgName=r,f.selGall.prevImgPath=e,f.selGall.prevImgType=o,f.selGall.pvIm=c.uploaderUrl+e+"thumbnail/"+r+o,f.selGall.hidePvIm=!0},f.activeGPw=function(){var e=angular.element(jQuery(".grsGallUpl")).scope(),r=angular.element(jQuery(".grsGallHeader")).scope();e.options.show||r.selectTab("Upl"),e.options.addImages&&(e.options.addAction="addGPvIm",e.options.addImages=!1,e.options.addImageTitle=f.getTrans("text_045"))},f.deleteGallery=function(e,r){void 0!==r&&r.stopPropagation();for(var o=0;o<f.galleriesData.length;o++)f.galleriesData[o].id==e&&(f.galleriesData.splice(o,1),f.galleriesData=angular.copy(f.galleriesData),f.selGall.id==e&&(f.selGall={id:"",title:"",description:"",pvIm:c.imagesDir+"thumbnail/grsnopv.png",imagesCount:0,images:[],prevImgPath:"",prevImgName:"grsnopv",prevImgType:".png"},f.items=[],f.search()));f.delAlbsContsFromPrnt(e,"gal")},f.addItem=function(e,r,o,t,a,n,s,i,l,g,c,d,u,m){f.pageSize++,f.itemsPerPage=f.pageSize,f.firstPage(),c=c||g;var p=""===i;f.items.splice(0,0,{name:e,title:r,description:o,path:t,link:a,order:n,type:s,embed:i,thumb_url:l,publish:1,key:g,id:c,hide:p,width:d,height:u,wp_sizes:m}),f.search()},f.addIdsToScopes=function(e,r){for(var o=0;o<e.length;o++)for(var t=f.pagedItems[f.currentPage].length-1;0<=t;t--)f.pagedItems[f.currentPage][t].key===e[o]&&(f.pagedItems[f.currentPage][t].id=r[o])},f.grsDeleteGImgPr=function(e,r){void 0!==e&&(e.preventDefault(),e.stopPropagation());var o=angular.element(jQuery(".grsGallConfirmMC")).scope(),t=jQuery(e.target).offset().left-jQuery(".grsGallFCont").offset().left,a=jQuery(e.target).offset().top-jQuery(".grsGallFCont").offset().top;o.options.left=t,o.options.top=a+25,o.options.actCnt=".grsGallContent","grsGallCoGaImDatAcDb"==e.target.className?(o.options.grsConMess=f.getTrans("text_046"),o.options.grsConIt=f.pagedItems[f.currentPage][r].title,o.options.grsConTp=f.getTrans("text_047"),o.options.actF="deleteImage",o.options.actP.push(r)):(o.options.grsConMess=f.getTrans("text_010"),o.options.grsConIt="",o.options.grsConTp="",o.options.actF="deleteItems",o.options.actP.push("")),o.options.show=!0},f.deleteImage=function(o){var t=angular.element(jQuery(".grsGallHeader")).scope();if(t.grsLoading)t.wmassage();else{var e=f.pagedItems[f.currentPage][o].id,a=f.itemsPerPage*f.currentPage+parseInt(o);grsAction="deleteImage",data={action:"grsGalleryAjax",grsAction:grsAction,id:e,grsAjaxNonce:grsAjaxNonce},t.grsLoading=!0,g({method:"POST",url:grsAdminAjax,data:jQuery.param(data),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(e){t.grsLoading=!1;var r=e.data;void 0===r.error?(f.pagedItems[f.currentPage][o].delete=!0,s(function(){f.items.splice(a,1),f.search()},500),t.grsMassage=f.getTrans("text_048"),t.grsMassageMood="success"):(t.grsMassage=""==r.error?f.getTrans("text_043"):r.error,t.grsMassageMood="error"),t.massage()},function(e){return c.log("errr"),$q.reject(e)})}},f.deleteItems=function(){var t=angular.element(jQuery(".grsGallHeader")).scope();if(t.grsLoading)t.wmassage();else{for(var e=f.pagedItems[f.currentPage],a=[],n=[],r=0;r<e.length;r++)if(e[r].select){f.itemsPerPage,f.currentPage,parseInt(r);a.push(e[r].id),n.push(e[r])}var o={action:"grsGalleryAjax",grsAction:"deleteImages",ids:a,grsAjaxNonce:grsAjaxNonce};t.grsLoading=!0,g({method:"POST",url:grsAdminAjax,data:jQuery.param(o),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(e){t.grsLoading=!1;var r=e.data;if(void 0===r.error){for(var o=0;o<n.length;o++)n[o].delete=!0;s(function(){for(var e=0;e<f.items.length;e++)for(var r=0;r<a.length;r++)f.items[e].id==a[r]&&f.items.splice(e,1);f.search()},500),t.grsMassage=f.getTrans("text_048"),t.grsMassageMood="success"}else t.grsMassage=""==r.error?f.getTrans("text_043"):r.error,t.grsMassageMood="error";t.massage()},function(e){return c.log("errr"),$q.reject(e)})}},f.selectItem=function(e){f.pagedItems[f.currentPage][e].select=!f.pagedItems[f.currentPage][e].select},f.selectItems=function(e){e.preventDefault();var r=f.pagedItems[f.currentPage],o=!1;if(void 0!==r){for(var t=0;t<r.length;t++)if(void 0===r[t].select||!r[t].select){o=!0;break}for(t=0;t<r.length;t++)r[t].select=o}},f.showItemInfo=function(e,r){r.stopPropagation(),f.pagedItems[f.currentPage][e].info=!f.pagedItems[f.currentPage][e].info},f.shEmCont=function(){return f.embed.show},f.showEmbedMedia=function(e){f.embed.show=!0,f.embed.type=e},f.closeEmbedMedia=function(){var e=f.embed;e.show=!1,e.type="",e.url=""},f.addEmbedMedia=function(){var o=f.embed,e=o.url,r=o.type,t=angular.element(jQuery(".grsGallHeader")).scope();if(""===e)return t.grsMassage=f.getTrans("text_050"),t.grsMassageMood="error",void t.massage();t.grsLoading=!0,n.embedMedia(r,e,f.selGall.id).then(function(e){if(t.grsLoading=!1,c.log(e),angular.isUndefined(e.data.error)){var r=e.data.success;f.addItem("",r.title,r.description,r.path,r.link,r.order,r.type,r.embed,r.thumb_url,r.id,null),t.grsMassage=f.getTrans("text_049"),t.grsMassageMood="success",f.closeEmbedMedia()}else o.url="",t.grsMassage=e.data.error,t.grsMassageMood="error";t.massage()},function(e){c.log(e)})},f.orderBy=function(e,r){f.reverse=void 0!==r&&(r.preventDefault(),e==f.order&&!f.reverse),f.order=e,f.items=a("orderBy")(f.items,f.order,f.reverse),f.search(!0)},f.changeItemsPerPage=function(){f.pageSize=void 0===f.pageSize||null==f.pageSize?1:f.pageSize,f.itemsPerPage=f.pageSize,f.search()};f.search=function(e){f.filteredItems=a("filter")(f.items,function(e){for(var r in e)if(e.id=parseInt(e.id),e.order=parseInt(e.order),"title"==r&&(o=e[r],!(t=f.query)||-1!==o.toLowerCase().indexOf(t.toLowerCase())))return!0;var o,t;return!1}),e||(f.currentPage=0),f.groupToPages()},f.groupToPages=function(){f.pagedItems=[];for(var e=0;e<f.filteredItems.length;e++)e%f.itemsPerPage==0?f.pagedItems[Math.floor(e/f.itemsPerPage)]=[f.filteredItems[e]]:f.pagedItems[Math.floor(e/f.itemsPerPage)].push(f.filteredItems[e])},f.range=function(e,r){var o=[];r||(r=e,e=0);for(var t=e;t<r;t++)o.push(t);return o},f.prevPage=function(){0<f.currentPage&&f.currentPage--},f.nextPage=function(){f.currentPage<f.pagedItems.length-1&&f.currentPage++},f.lastPage=function(){f.currentPage<f.pagedItems.length-1&&(f.currentPage=f.pagedItems.length-1)},f.firstPage=function(){0<f.currentPage&&(f.currentPage=0)},f.setPage=function(){f.currentPage=this.n},f.getTrans=c.getTrans}}}]),grsApp.directive("grsThemes",["$filter","$http","$timeout","GrsAdminService",function(e,n,r,s){return{restrict:"E",transclude:!0,scope:!1,template:'<div ng-if="shThemes()" onload="themeContLoaded()" ng-include="options.themeUrl"></div>',link:function(i,r,e){i.pluginUrl=s.pluginUrl,i.grsSelectedTheme={thumbnail:{},film:{},carousel3d:{},masonry:{},mosaic:{},navigation:{},lightbox:{}},i.options={themeUrl:s.getViewsTemplateUrl("grsThemes"),view:"Thumbnail",lightboxMain:!1,lightboxCloseButton:!1,lightboxTitle:!1,lightboxTitleCont:!1,lightboxOnlyDesc:!1,lightboxOnlyTitle:!1,lightboxImageCo:!1,lightboxNav:!1,lightboxFilm:!1,lightboxFilmCont:!1,lightboxFilmNav:!1,lightboxContButt:!1,lightboxContButtCont:!1,lightboxContButtButts:!1,lightboxComm:!1,lightboxCommCont:!1,lightboxCommLabels:!1,lightboxCommInp:!1,lightboxCommCButt:!1,lightboxCommCpButt:!1,lightboxCommAuth:!1,lightboxCommText:!1,lightboxCommDate:!1,thumbnailImg:!1,thumbnailTitle:!1,masonryImg:!1,masonryTitle:!1,mosaicImg:!1,mosaicTitle:!1,navMainCont:!1,navButtons:!1,navBackButton:!1,navIconsHide:!0,filmNavIconsHide:!0,contIconsHide:!0,fmNavIcons:!1,fmNavIconsHide:!0},i.showHideParts=function(e){i.options[e]=!i.options[e]},i.showNavButtsV=[{value:"no",name:"No",class:"noneOp"},{value:"onhover",name:"On hover",class:""},{value:"always",name:"Always",class:""}],i.nBEffects=[{value:"no",name:"No effect",class:"noneOp"},{value:"fade",name:"Fade",class:""},{value:"slideIn",name:"Slide In",class:""},{value:"rotateIn",name:"Rotate In",class:""}],i.navButtShButtsCh=function(){i.grsSelectedTheme.showNavBuutEff="onhover"===i.grsSelectedTheme.lightbox.navButtShButts},i.navButtShButtsCh=function(){i.grsSelectedTheme.showNavBuutEff="onhover"===i.grsSelectedTheme.lightbox.navButtShButts},i.ftSEffects=[{value:"no",name:"No effect",class:"noneOp"},{value:"fadeIn",name:"Fade In",class:""},{value:"fadeOut",name:"Fade Out",class:""},{value:"zoom",name:"Zoom",class:""},{value:"rotate",name:"Rotate",class:""},{value:"border",name:"Border",class:""}],i.hoverEffects=[{value:"none",name:"None",class:"noneOp"},{value:"scaleIm",name:"Zoom(image)",class:""},{value:"scaleRotIm",name:"Zoom + rotate(image)",class:""},{value:"scaleTransIm",name:"Zoom + translate(image)",class:""},{value:"scale",name:"Zoom",class:""},{value:"rotate",name:"Rotate",class:""},{value:"grayscale",name:"Gray",class:""},{value:"sepia",name:"Sepia",class:""},{value:"flash",name:"Flash",class:""},{value:"blur",name:"Blur + grayscale",class:""},{value:"shine",name:"Shine",class:""},{value:"circle",name:"Circle",class:""}],i.borderStyles=[{value:"none",name:"None"},{value:"hidden",name:"Hidden"},{value:"dotted",name:"Dotted"},{value:"dashed",name:"Dashed"},{value:"solid",name:"Solid"},{value:"double",name:"Double"},{value:"groove",name:"Groove"},{value:"ridge",name:"Ridge"},{value:"inset",name:"Inset"},{value:"outset",name:"Outset"},{value:"initial",name:"Initial"}],i.fontFamilies=[{value:"cursive",name:"Cursive",class:""},{value:"fantasy",name:"Fantasy",class:""},{value:"inherit",name:"Inherit",class:""},{value:"monospace",name:"Monospace",class:""},{value:"sans-serif",name:"Sans-serif",class:""},{value:"serif",name:"Serif",class:""},{value:"Georgia",name:"Georgia",class:""},{value:"Architex",name:"Architex",class:""},{value:"Peterbuilt",name:"Peterbuilt",class:""},{value:"Max",name:"Max",class:""},{value:"WIREDsaji",name:"WIREDsaji",class:""},{value:"CoventryGardenNF",name:"CoventryGardenNF",class:""},{value:"Femkeklaver",name:"Femkeklaver",class:""},{value:"Caeldera",name:"Caeldera",class:""}],i.fontWeights=[{value:"100",name:"100",class:""},{value:"200",name:"200",class:""},{value:"300",name:"300",class:""},{value:"400",name:"400",class:""},{value:"500",name:"500",class:""},{value:"600",name:"600",class:""},{value:"700",name:"700",class:""},{value:"800",name:"800",class:""},{value:"900",name:"900",class:""},{value:"bold",name:"Bold",class:""},{value:"bolder",name:"Bolder",class:""},{value:"inherit",name:"Inherit",class:""},{value:"initial",name:"Initial",class:""},{value:"lighter",name:"Lighter",class:""},{value:"normal",name:"Normal",class:""}],i.fontStyles=[{value:"italic",name:"Italic",class:""},{value:"inherit",name:"Inherit",class:""},{value:"normal",name:"Normal",class:""},{value:"oblique",name:"Oblique",class:""}],i.tPoss=[{value:"top",name:"Top",class:""},{value:"middle",name:"Middle",class:""},{value:"bottom",name:"Bottom",class:""}],i.align=[{value:"left",name:"Left",class:""},{value:"center",name:"Center",class:""},{value:"right",name:"Right",class:""}],i.tEffects=[{value:"no",name:"No effect",class:"noneOp"},{value:"grsFadeIn",name:"Fade in",class:""},{value:"grsSlideInLeft",name:"Slide in left",class:""},{value:"grsSlideInRight",name:"Slide in right",class:""},{value:"grsSlideInUp",name:"Slide in up",class:""},{value:"grsSlideInDown",name:"Slide in down",class:""},{value:"grsZoomIn",name:"Zoom In",class:""},{value:"grsTransUp",name:"Translate up",class:""},{value:"grsRotateX",name:"Rotate x",class:""},{value:"grsRotateY",name:"Rotate y",class:""},{value:"grsBounceIn",name:"Bounce in",class:""},{value:"grsBounceInDown",name:"Bounce in down",class:""},{value:"grsBounceInLeft",name:"Bounce in left",class:""},{value:"grsFlipInX",name:"Flip in x",class:""},{value:"grsFlipInY",name:"Flip in y",class:""},{value:"grsRollIn",name:"Roll in",class:""},{value:"mask",name:"Mask",class:""}],i.contButtOnhovers=[{value:"0",name:"Active"},{value:"1",name:"Passvie"},{value:"2",name:"Same"}],i.gradientDirections=[{value:"180deg",name:"From top to bottom"},{value:"0deg",name:"From bottom to top"},{value:"90deg",name:"From left to right"},{value:"-90deg",name:"From right to left"}],i.positionTypes=[{value:"topRight",name:"Top right"},{value:"topCenter",name:"Top center"},{value:"topLeft",name:"Top left"},{value:"bottomLeft",name:"Bottom left"},{value:"bottomCenter",name:"Bottom center"},{value:"bottomRight",name:"Bottom right"},{value:"center",name:"Center"}],i.getThemeItems=function(){var t=angular.element(jQuery(".grsGallHeader")).scope(),e={action:"grsGalleryAjax",grsAction:"getThemeItems",grsAjaxNonce:grsAjaxNonce};t.grsLoading=!0,n({method:"POST",url:grsAdminAjax,data:jQuery.param(e),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(e){t.grsLoading=!1;var r=e.data;if(s.log(e),void 0===r.error){i.grsThemes=r.success.grsThemes,i.newTheme=r.success.newTheme;for(var o=0;o<i.grsThemes.length;o++)if(1==i.grsThemes[o].default){i.grsChangeTheme(o);break}}else t.grsMassage=""==r.error?i.getTrans("text_051"):r.error,t.grsMassageMood="error",t.massage()},function(e){return s.log("errr"),t.grsLoading=!1,t.grsMassage=i.getTrans("text_051"),t.grsMassageMood="error",t.massage(!1),$q.reject(e)})},i.getThemeItems(),i.themeContLoaded=function(){r.find(".thumbnailTBgcolor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".thumbnailTcolor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".thumbnailMaskColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".thumbnailBorderColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".thumbnailBoxshadowColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".thumbnailBgColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".fmBgColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".fmThumbBorderColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".fmThumbBoxshadowColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".fmThumbBgColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".fmNavBgColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".fmNavHoverBgColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".fmNavColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".fmNavHoverColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".fmNavBoxshadowColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".fmNavBorderColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".fmTBgcolor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".fmTcolor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".crs3dBgColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".crs3dThumbBorderColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".crs3dThumbBoxshadowColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".crs3dThumbBgColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".crs3dTBgcolor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".crs3dTcolor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".masonryBorderColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".masonryBoxshadowColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".masonryBgColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".masonryTBgcolor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".masonryTcolor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".mosaicBgColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".mosaicBoxshadowColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".mosaicBorderColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".mosaicTBgcolor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".mosaicTcolor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".bgColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".boxBgColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".closeButtBgColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".closeButtColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".closeButtHoverColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".closeButtBoxshadowColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".closeButtBorderColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".titleDescpBgGrFrColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".titleDescpBgGrToColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".titleDescpTColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".titleDescpDColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".titleDescpshadowColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".imgcoBgColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".imgcoColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".imgcoshadowColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".navButtBgColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".navButtColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".navButtHoverColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".navButtBoxshadowColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".navButtShadowColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".navButtHoverShadowColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".navButtBorderColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".filmstripBgColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".filmThumbBorderColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".filmThumbBoxshadowColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".filmSelThumbBorderColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".filmThumbBgColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".filmNavBgColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".filmNavHoverBgColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".filmNavButtColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".filmNavButtHoverColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".filmNavBoxshadowColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".filmNavBorderColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".contButtContBgGrFrColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".contButtContBgGrToColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".contButtContBoxshadowColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".contButtBgColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".contButtHoverBgColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".contButtColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".contButtHoverColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".contButtBoxshadowColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".contButtShadowColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".contButtBorderColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".contButtContBorderColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".commContBgcolor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".commFontColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".commButtBgcolor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".commButtHBgcolor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".commButtBoxshadowColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".commInpColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".commInpBoxshadowColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".commInpBorderColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".commInpBgColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".commInpAcBorderColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".commInpAcBoxshadowColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".commButtColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".commButtBorderColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".commClButtBoxshadowColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".commClButtHoverColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".commClButtColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".commClButtBgColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".commClButtBorderColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".commCpButtBoxshadowColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".commCpButtBgColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".commCpButtColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".commCpButtHoverColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".commCpButtBorderColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".commAFontColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".commTFontColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".commDFontColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".pnavBBorderColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".pnavBBoxshadowColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".pnavBBgColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".pnavBHBgColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".pnavBABgColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".pnavBcolor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".backBoxshadowColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".backBgColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".backHBgColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".backColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")}),r.find(".backBorderColor").colorpicker({format:"rgba"}).on("changeColor.colorpicker",function(e){jQuery(this).find("input").trigger("input")})},i.grsChangeTheme=function(e){i.grsSelectedTheme=i.grsThemes[e],i.navButtShButtsCh(),r.find(".thumbnailTBgcolor").colorpicker("setValue",i.grsSelectedTheme.thumbnail.thumbnailTBgcolor),r.find(".thumbnailTcolor").colorpicker("setValue",i.grsSelectedTheme.thumbnail.thumbnailTcolor),r.find(".thumbnailMaskColor").colorpicker("setValue",i.grsSelectedTheme.thumbnail.thumbnailMaskColor),r.find(".thumbnailBorderColor").colorpicker("setValue",i.grsSelectedTheme.thumbnail.thumbnailBorderColor),r.find(".thumbnailBoxshadowColor").colorpicker("setValue",i.grsSelectedTheme.thumbnail.thumbnailBoxshadowColor),r.find(".thumbnailBgColor").colorpicker("setValue",i.grsSelectedTheme.thumbnail.thumbnailBgColor),r.find(".masonryBorderColor").colorpicker("setValue",i.grsSelectedTheme.masonry.masonryBorderColor),r.find(".masonryBoxshadowColor").colorpicker("setValue",i.grsSelectedTheme.masonry.masonryBoxshadowColor),r.find(".masonryBgColor").colorpicker("setValue",i.grsSelectedTheme.masonry.masonryBgColor),r.find(".masonryTBgcolor").colorpicker("setValue",i.grsSelectedTheme.masonry.masonryTBgcolor),r.find(".masonryTcolor").colorpicker("setValue",i.grsSelectedTheme.masonry.masonryTcolor),r.find(".fmBgColor").colorpicker("setValue",i.grsSelectedTheme.film.fmBgColor),r.find(".fmThumbBorderColor").colorpicker("setValue",i.grsSelectedTheme.film.fmThumbBorderColor),r.find(".fmThumbBoxshadowColor").colorpicker("setValue",i.grsSelectedTheme.film.fmThumbBoxshadowColor),r.find(".fmThumbBgColor").colorpicker("setValue",i.grsSelectedTheme.film.fmThumbBgColor),r.find(".fmNavBgColor").colorpicker("setValue",i.grsSelectedTheme.film.fmNavBgColor),r.find(".fmNavHoverBgColor").colorpicker("setValue",i.grsSelectedTheme.film.fmNavHoverBgColor),r.find(".fmNavColor").colorpicker("setValue",i.grsSelectedTheme.film.fmNavColor),r.find(".fmNavHoverColor").colorpicker("setValue",i.grsSelectedTheme.film.fmNavHoverColor),r.find(".fmNavBoxshadowColor").colorpicker("setValue",i.grsSelectedTheme.film.fmNavBoxshadowColor),r.find(".fmNavBorderColor").colorpicker("setValue",i.grsSelectedTheme.film.fmNavBorderColor),r.find(".fmTBgcolor").colorpicker("setValue",i.grsSelectedTheme.film.fmTBgcolor),r.find(".fmTcolor").colorpicker("setValue",i.grsSelectedTheme.film.fmTcolor),r.find(".crs3dBgColor").colorpicker("setValue",i.grsSelectedTheme.carousel3d.crs3dBgColor),r.find(".crs3dThumbBorderColor").colorpicker("setValue",i.grsSelectedTheme.carousel3d.crs3dThumbBorderColor),r.find(".crs3dThumbBoxshadowColor").colorpicker("setValue",i.grsSelectedTheme.carousel3d.crs3dThumbBoxshadowColor),r.find(".crs3dThumbBgColor").colorpicker("setValue",i.grsSelectedTheme.carousel3d.crs3dThumbBgColor),r.find(".crs3dTBgcolor").colorpicker("setValue",i.grsSelectedTheme.carousel3d.crs3dTBgcolor),r.find(".crs3dTcolor").colorpicker("setValue",i.grsSelectedTheme.carousel3d.crs3dTcolor),r.find(".mosaicBorderColor").colorpicker("setValue",i.grsSelectedTheme.mosaic.mosaicBorderColor),r.find(".mosaicBoxshadowColor").colorpicker("setValue",i.grsSelectedTheme.mosaic.mosaicBoxshadowColor),r.find(".mosaicBgColor").colorpicker("setValue",i.grsSelectedTheme.mosaic.mosaicBgColor),r.find(".mosaicTBgcolor").colorpicker("setValue",i.grsSelectedTheme.mosaic.mosaicTBgcolor),r.find(".mosaicTcolor").colorpicker("setValue",i.grsSelectedTheme.mosaic.mosaicTcolor),r.find(".pnavBBorderColor").colorpicker("setValue",i.grsSelectedTheme.navigation.pnavBBorderColor),r.find(".pnavBBoxshadowColor").colorpicker("setValue",i.grsSelectedTheme.navigation.pnavBBoxshadowColor),r.find(".pnavBBgColor").colorpicker("setValue",i.grsSelectedTheme.navigation.pnavBBgColor),r.find(".pnavBHBgColor").colorpicker("setValue",i.grsSelectedTheme.navigation.pnavBHBgColor),r.find(".pnavBABgColor").colorpicker("setValue",i.grsSelectedTheme.navigation.pnavBABgColor),r.find(".pnavBcolor").colorpicker("setValue",i.grsSelectedTheme.navigation.pnavBcolor),r.find(".backBoxshadowColor").colorpicker("setValue",i.grsSelectedTheme.navigation.backBoxshadowColor),r.find(".backBgColor").colorpicker("setValue",i.grsSelectedTheme.navigation.backBgColor),r.find(".backHBgColor").colorpicker("setValue",i.grsSelectedTheme.navigation.backHBgColor),r.find(".backColor").colorpicker("setValue",i.grsSelectedTheme.navigation.backColor),r.find(".backBorderColor").colorpicker("setValue",i.grsSelectedTheme.navigation.backBorderColor),r.find(".bgColor").colorpicker("setValue",i.grsSelectedTheme.lightbox.bgColor),r.find(".boxBgColor").colorpicker("setValue",i.grsSelectedTheme.lightbox.boxBgColor),r.find(".closeButtBgColor").colorpicker("setValue",i.grsSelectedTheme.lightbox.closeButtBgColor),r.find(".closeButtColor").colorpicker("setValue",i.grsSelectedTheme.lightbox.closeButtColor),r.find(".closeButtHoverColor").colorpicker("setValue",i.grsSelectedTheme.lightbox.closeButtHoverColor),r.find(".closeButtBoxshadowColor").colorpicker("setValue",i.grsSelectedTheme.lightbox.closeButtBoxshadowColor),r.find(".closeButtBorderColor").colorpicker("setValue",i.grsSelectedTheme.lightbox.closeButtBorderColor),r.find(".titleDescpBgGrFrColor").colorpicker("setValue",i.grsSelectedTheme.lightbox.titleDescpBgGrFrColor),r.find(".titleDescpBgGrToColor").colorpicker("setValue",i.grsSelectedTheme.lightbox.titleDescpBgGrToColor),r.find(".titleDescpTColor").colorpicker("setValue",i.grsSelectedTheme.lightbox.titleDescpTColor),r.find(".titleDescpDColor").colorpicker("setValue",i.grsSelectedTheme.lightbox.titleDescpDColor),r.find(".titleDescpshadowColor").colorpicker("setValue",i.grsSelectedTheme.lightbox.titleDescpshadowColor),r.find(".imgcoBgColor").colorpicker("setValue",i.grsSelectedTheme.lightbox.imgcoBgColor),r.find(".imgcoColor").colorpicker("setValue",i.grsSelectedTheme.lightbox.imgcoColor),r.find(".imgcoshadowColor").colorpicker("setValue",i.grsSelectedTheme.lightbox.imgcoshadowColor),r.find(".navButtColor").colorpicker("setValue",i.grsSelectedTheme.lightbox.navButtColor),r.find(".navButtHoverColor").colorpicker("setValue",i.grsSelectedTheme.lightbox.navButtHoverColor),r.find(".navButtBgColor").colorpicker("setValue",i.grsSelectedTheme.lightbox.navButtBgColor),r.find(".navButtBoxshadowColor").colorpicker("setValue",i.grsSelectedTheme.lightbox.navButtBoxshadowColor),r.find(".navButtShadowColor").colorpicker("setValue",i.grsSelectedTheme.lightbox.navButtShadowColor),r.find(".navButtHoverShadowColor").colorpicker("setValue",i.grsSelectedTheme.lightbox.navButtHoverShadowColor),r.find(".navButtBorderColor").colorpicker("setValue",i.grsSelectedTheme.lightbox.navButtBorderColor),r.find(".filmstripBgColor").colorpicker("setValue",i.grsSelectedTheme.lightbox.filmstripBgColor),r.find(".filmThumbBorderColor").colorpicker("setValue",i.grsSelectedTheme.lightbox.filmThumbBorderColor),r.find(".filmThumbBoxshadowColor").colorpicker("setValue",i.grsSelectedTheme.lightbox.filmThumbBoxshadowColor),r.find(".filmSelThumbBorderColor").colorpicker("setValue",i.grsSelectedTheme.lightbox.filmSelThumbBorderColor),r.find(".filmThumbBgColor").colorpicker("setValue",i.grsSelectedTheme.lightbox.filmThumbBgColor),r.find(".filmNavBgColor").colorpicker("setValue",i.grsSelectedTheme.lightbox.filmNavBgColor),r.find(".filmNavHoverBgColor").colorpicker("setValue",i.grsSelectedTheme.lightbox.filmNavHoverBgColor),r.find(".filmNavButtColor").colorpicker("setValue",i.grsSelectedTheme.lightbox.filmNavButtColor),r.find(".filmNavButtHoverColor").colorpicker("setValue",i.grsSelectedTheme.lightbox.filmNavButtHoverColor),r.find(".filmNavBoxshadowColor").colorpicker("setValue",i.grsSelectedTheme.lightbox.filmNavBoxshadowColor),r.find(".filmNavBorderColor").colorpicker("setValue",i.grsSelectedTheme.lightbox.filmNavBorderColor),r.find(".contButtContBgGrFrColor").colorpicker("setValue",i.grsSelectedTheme.lightbox.contButtContBgGrFrColor),r.find(".contButtContBgGrToColor").colorpicker("setValue",i.grsSelectedTheme.lightbox.contButtContBgGrToColor),r.find(".contButtContBoxshadowColor").colorpicker("setValue",i.grsSelectedTheme.lightbox.contButtContBoxshadowColor),r.find(".contButtBgColor").colorpicker("setValue",i.grsSelectedTheme.lightbox.contButtBgColor),r.find(".contButtHoverBgColor").colorpicker("setValue",i.grsSelectedTheme.lightbox.contButtHoverBgColor),r.find(".contButtColor").colorpicker("setValue",i.grsSelectedTheme.lightbox.contButtColor),r.find(".contButtHoverColor").colorpicker("setValue",i.grsSelectedTheme.lightbox.contButtHoverColor),r.find(".contButtBoxshadowColor").colorpicker("setValue",i.grsSelectedTheme.lightbox.contButtBoxshadowColor),r.find(".contButtShadowColor").colorpicker("setValue",i.grsSelectedTheme.lightbox.contButtShadowColor),r.find(".contButtBorderColor").colorpicker("setValue",i.grsSelectedTheme.lightbox.contButtBorderColor),r.find(".contButtContBorderColor").colorpicker("setValue",i.grsSelectedTheme.lightbox.contButtContBorderColor),r.find(".commContBgcolor").colorpicker("setValue",i.grsSelectedTheme.lightbox.commContBgcolor),r.find(".commFontColor").colorpicker("setValue",i.grsSelectedTheme.lightbox.commFontColor),r.find(".commButtBgcolor").colorpicker("setValue",i.grsSelectedTheme.lightbox.commButtBgcolor),r.find(".commButtHBgcolor").colorpicker("setValue",i.grsSelectedTheme.lightbox.commButtHBgcolor),r.find(".commButtBoxshadowColor").colorpicker("setValue",i.grsSelectedTheme.lightbox.commButtBoxshadowColor),r.find(".commInpColor").colorpicker("setValue",i.grsSelectedTheme.lightbox.commInpColor),r.find(".commInpBoxshadowColor").colorpicker("setValue",i.grsSelectedTheme.lightbox.commInpBoxshadowColor),r.find(".commInpBorderColor").colorpicker("setValue",i.grsSelectedTheme.lightbox.commInpBorderColor),r.find(".commInpBgColor").colorpicker("setValue",i.grsSelectedTheme.lightbox.commInpBgColor),r.find(".commInpAcBorderColor").colorpicker("setValue",i.grsSelectedTheme.lightbox.commInpAcBorderColor),r.find(".commInpAcBoxshadowColor").colorpicker("setValue",i.grsSelectedTheme.lightbox.commInpAcBoxshadowColor),r.find(".commButtColor").colorpicker("setValue",i.grsSelectedTheme.lightbox.commButtColor),r.find(".commButtBorderColor").colorpicker("setValue",i.grsSelectedTheme.lightbox.commButtBorderColor),r.find(".commClButtBoxshadowColor").colorpicker("setValue",i.grsSelectedTheme.lightbox.commClButtBoxshadowColor),r.find(".commClButtBgColor").colorpicker("setValue",i.grsSelectedTheme.lightbox.commClButtBgColor),r.find(".commClButtBorderColor").colorpicker("setValue",i.grsSelectedTheme.lightbox.commClButtBorderColor),r.find(".commClButtColor").colorpicker("setValue",i.grsSelectedTheme.lightbox.commClButtColor),r.find(".commClButtHoverColor").colorpicker("setValue",i.grsSelectedTheme.lightbox.commClButtHoverColor),r.find(".commCpButtBoxshadowColor").colorpicker("setValue",i.grsSelectedTheme.lightbox.commCpButtBoxshadowColor),r.find(".commCpButtBgColor").colorpicker("setValue",i.grsSelectedTheme.lightbox.commCpButtBgColor),r.find(".commCpButtColor").colorpicker("setValue",i.grsSelectedTheme.lightbox.commCpButtColor),r.find(".commCpButtHoverColor").colorpicker("setValue",i.grsSelectedTheme.lightbox.commCpButtHoverColor),r.find(".commCpButtBorderColor").colorpicker("setValue",i.grsSelectedTheme.lightbox.commCpButtBorderColor),r.find(".commAFontColor").colorpicker("setValue",i.grsSelectedTheme.lightbox.commAFontColor),r.find(".commTFontColor").colorpicker("setValue",i.grsSelectedTheme.lightbox.commTFontColor),r.find(".commDFontColor").colorpicker("setValue",i.grsSelectedTheme.lightbox.commDFontColor)},i.grsAddTheme=function(){var o=angular.element(jQuery(".grsGallHeader")).scope();if(o.grsLoading)o.wmassage();else{var e={action:"grsGalleryAjax",grsAction:"addTheme",grsAjaxNonce:grsAjaxNonce};o.grsLoading=!0,n({method:"POST",url:grsAdminAjax,data:jQuery.param(e),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(e){o.grsLoading=!1;var r=e.data;s.log(e),void 0===r.error?(i.grsThemes.push(r.success),i.grsChangeTheme(i.grsThemes.length-1),o.grsMassage=i.getTrans("text_052"),o.grsMassageMood="success"):(o.grsMassage=i.getTrans("text_043"),o.grsMassageMood="error"),o.massage()},function(e){return s.log("errr"),$q.reject(e)})}},i.saveTheme=function(){var o=angular.element(jQuery(".grsGallHeader")).scope();if(o.grsLoading)o.wmassage();else{var e={action:"grsGalleryAjax",grsAction:"updateTheme",theme:i.grsSelectedTheme,grsAjaxNonce:grsAjaxNonce};o.grsLoading=!0,n({method:"POST",url:grsAdminAjax,data:jQuery.param(e),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(e){o.grsLoading=!1;var r=e.data;s.log(r),void 0===r.error?(i.grsSelectedTheme.name=r.success[0],o.grsMassage=i.getTrans("text_052"),o.grsMassageMood="success"):(o.grsMassage=""==r.error?i.getTrans("text_043"):r.error,o.grsMassageMood="error"),o.massage()},function(e){return s.log("errr"),$q.reject(e)})}},i.grsDeleteThemePr=function(e,r){void 0!==e&&e.stopPropagation();var o=i.grsThemes[r].default,t=angular.element(jQuery(".grsGallHeader")).scope();if(1==o)return t.grsMassage=i.getTrans("text_053"),t.grsMassageMood="error",void t.massage();var a=angular.element(jQuery(".grsGallConfirmMC")).scope(),n=jQuery(e.target).offset().left-jQuery(".grsGallFCont").offset().left,s=jQuery(e.target).offset().top-jQuery(".grsGallFCont").offset().top;a.options.show=!0,a.options.left=n,a.options.top=s+25,a.options.grsConMess=i.getTrans("text_046"),a.options.grsConIt=i.grsThemes[r].name,a.options.grsConTp=i.getTrans("text_054"),a.options.actCnt=".grsGallContent",a.options.actF="grsDeleteTheme",a.options.actP.push(r)},i.grsDeleteTheme=function(t){var a=angular.element(jQuery(".grsGallHeader")).scope();if(a.grsLoading)a.wmassage();else{var e={action:"grsGalleryAjax",grsAction:"deleteTheme",id:i.grsThemes[t].id,grsAjaxNonce:grsAjaxNonce};a.grsLoading=!0,n({method:"POST",url:grsAdminAjax,data:jQuery.param(e),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(e){a.grsLoading=!1;var r=e.data;if(void 0===r.error){if(i.grsSelectedTheme.id==i.grsThemes[t].id)for(var o=0;o<i.grsThemes.length;o++)1==i.grsThemes[o].default&&i.grsChangeTheme(o);i.grsThemes.splice(t,1),a.grsMassage=i.getTrans("text_055"),a.grsMassageMood="success"}else a.grsMassage=""==r.error?i.getTrans("text_043"):r.error,a.grsMassageMood="error";a.massage()},function(e){return s.log("errr"),$q.reject(e)})}},i.default=function(t){var a=angular.element(jQuery(".grsGallHeader")).scope();if(a.grsLoading)a.wmassage();else{var e={action:"grsGalleryAjax",grsAction:"setDefault",id:i.grsThemes[t].id,grsAjaxNonce:grsAjaxNonce};1!=i.grsThemes[t].default&&(a.grsLoading=!0,n({method:"POST",url:grsAdminAjax,data:jQuery.param(e),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(e){a.grsLoading=!1;var r=e.data;if(void 0===r.error){for(var o=0;o<i.grsThemes.length;o++)if(1==i.grsThemes[o].default){i.grsThemes[o].default=0;break}i.grsThemes[t].default=1,a.grsMassage=i.getTrans("text_052"),a.grsMassageMood="success"}else a.grsMassage=""==r.error?i.getTrans("text_043"):r.error,a.grsMassageMood="error";a.massage()},function(e){return s.log("errr"),$q.reject(e)}))}},i.grsThemeView=function(e){i.options.view=e},i.getTrans=s.getTrans}}}]),grsApp.directive("grsAlbums",["$filter","$http","GrsAdminService",function(e,i,l){return{restrict:"E",transclude:!0,scope:!1,templateUrl:l.getViewsTemplateUrl("grsAlbums"),link:function(s,e,r){s.grsAlbums=[],s.grsGalleriesForAlb=[],s.showGallsForAdd=!1,s.showAlbsForAdd=!1,s.grsAlbAction="",s.pageination={items:[],currentPage:0,itemsPerPage:5},s.$watch("galleriesData",function(){s.grsGalleriesForAlb=angular.copy(s.galleriesData),s.$$phase||s.$apply()}),s.getAlbItems=function(){var o=angular.element(jQuery(".grsGallHeader")).scope(),e={action:"grsGalleryAjax",grsAction:"getAlbumItems",grsAjaxNonce:grsAjaxNonce};o.grsLoading=!0,i({method:"POST",url:grsAdminAjax,data:jQuery.param(e),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(e){o.grsLoading=!1;var r=e.data;void 0===r.error?s.grsAlbums=r.success:(o.grsMassage=s.getTrans("text_056"),o.grsMassageMood="error",o.massage())},function(e){return l.log("errr"),o.grsLoading=!1,o.grsMassage=s.getTrans("text_056"),o.grsMassageMood="error",o.massage(!1),$q.reject(e)})},s.getAlbItems(),s.contForAdd=function(e){s.selAlbExists()&&("gall"==e?s.showGallsForAdd=!s.showGallsForAdd:"alb"==e&&(s.showAlbsForAdd=!s.showAlbsForAdd))},s.$watch("grsAlbums",function(){switch(s.pageination.items=angular.copy(s.grsAlbums),void 0!==s.pageination.search&&s.pageination.search(),s.grsAlbAction){case"addAlbum":s.pageination.firstPage(),s.grsChangeAlbum(0);break;case"updateAlbum":for(var e=0;e<s.pageination.pagedItems.length;e++)for(var r=0;r<s.pageination.pagedItems[e].length;r++)if(s.pageination.pagedItems[e][r].id==s.grsSelectedAlbum.id){s.pageination.currentPage=e;break}break;case"deleteAlbum":case"deleteAlbContent":if(void 0===s.grsSelectedAlbum)return;for(e=0;e<s.pageination.pagedItems.length;e++)for(r=0;r<s.pageination.pagedItems[e].length;r++)if(s.pageination.pagedItems[e][r].id==s.grsSelectedAlbum.id){s.grsSelectedAlbum.content=s.pageination.pagedItems[e][r].content;break}break;case"addAlbContent":for(e=0;e<s.grsAlbums.length;e++)if(s.grsAlbums[e].id==s.grsSelectedAlbum.id){s.grsAlbums[e].content=s.grsSelectedAlbum.content;break}s.pageination.items=angular.copy(s.grsAlbums),s.pageination.search();break;default:return}s.grsAlbAction="",s.$$phase||s.$apply()}),s.$watch("pageination.currentPage",function(){s.isAllChecked=!1,s.checkAll()}),s.checkAll=function(){var r=s.isAllChecked,e=s.pageination;e.pagedItems&&angular.forEach(e.pagedItems[e.currentPage],function(e){e.checked=r})},s.checked=function(){var e=s.pageination;s.isAllChecked=e.pagedItems[e.currentPage].every(function(e){return e.checked})},s.grsChangeAlbum=function(e){s.grsSelectedAlbum=s.pageination.pagedItems[s.pageination.currentPage][e];var r="grsnopv"==s.grsSelectedAlbum.prevImgName?l.imagesDir:l.uploaderUrl;s.grsSelectedAlbum.pvAlbIm=r+s.grsSelectedAlbum.prevImgPath+"thumbnail/"+s.grsSelectedAlbum.prevImgName+s.grsSelectedAlbum.prevImgType},s.grsAddAlbum=function(){var t=angular.element(jQuery(".grsGallHeader")).scope();if(t.grsLoading)t.wmassage();else{var e={action:"grsGalleryAjax",grsAction:"addUpdateAlbum",grsAjaxNonce:grsAjaxNonce};t.grsLoading=!0,i({method:"POST",url:grsAdminAjax,data:jQuery.param(e),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(e){l.log(e),t.grsLoading=!1;var r=e.data;if(void 0===r.error){var o={id:r.success[0],title:r.success[1],description:"",content:[],prevImgPath:"",prevImgName:"grsnopv",prevImgType:".png"};s.grsAlbums.push(o),s.grsAlbums=angular.copy(s.grsAlbums),s.grsAlbAction="addAlbum",t.grsMassage=s.getTrans("text_057"),t.grsMassageMood="success"}else t.grsMassage=""==r.error?s.getTrans("text_043"):r.error,t.grsMassageMood="error";t.massage()},function(e){return l.log("errr"),$q.reject(e)})}},s.saveAlb=function(){var t=angular.element(jQuery(".grsGallHeader")).scope();if(t.grsLoading)t.wmassage();else if(s.selAlbExists()){var e={action:"grsGalleryAjax",grsAction:"addUpdateAlbum",album:s.grsSelectedAlbum,grsAjaxNonce:grsAjaxNonce};t.grsLoading=!0,i({method:"POST",url:grsAdminAjax,data:jQuery.param(e),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(e){t.grsLoading=!1;var r=e.data;if(void 0===r.error){for(var o=0;o<s.grsAlbums.length;o++)s.grsAlbums[o].id==s.grsSelectedAlbum.id&&(s.grsSelectedAlbum.title=r.success[0],s.grsAlbums[o]=s.grsSelectedAlbum,s.updateAlbsContents(s.grsSelectedAlbum.id,r.success[0],"alb"));t.grsMassage=s.getTrans("text_057"),t.grsMassageMood="success"}else t.grsMassage=""==r.error?s.getTrans("text_043"):r.error,t.grsMassageMood="error";t.massage()},function(e){return l.log("errr"),$q.reject(e)})}},s.grsDeleteAlbumPr=function(e,r){void 0!==e&&e.stopPropagation();var o=angular.element(jQuery(".grsGallConfirmMC")).scope(),t=jQuery(e.target).offset().left-jQuery(".grsGallFCont").offset().left,a=jQuery(e.target).offset().top-jQuery(".grsGallFCont").offset().top;o.options.left=t,o.options.top=a+25,o.options.actCnt=".grsGallContent","SPAN"==e.target.nodeName?(o.options.grsConMess=s.getTrans("text_046"),o.options.grsConIt=s.grsAlbums[r].title,o.options.grsConTp=s.getTrans("text_058"),o.options.actF="grsDeleteAlbum",o.options.actP.push(r)):(o.options.grsConMess=s.getTrans("text_011"),o.options.actF="grsDeleteAlbums",o.options.actP.push("")),o.options.show=!0},s.grsDeleteAlbum=function(e){var r=[],o=s.pageination;r.push(o.pagedItems[o.currentPage][e].id),s.deleteAlbums(r)},s.grsDeleteAlbums=function(){for(var e=[],r=s.pageination,o=0;o<r.pagedItems[r.currentPage].length;o++)r.pagedItems[r.currentPage][o].checked&&e.push(r.pagedItems[r.currentPage][o].id);0<e.length&&s.deleteAlbums(e)},s.deleteAlbums=function(a){var n=angular.element(jQuery(".grsGallHeader")).scope();if(n.grsLoading)n.wmassage();else{var e={action:"grsGalleryAjax",grsAction:"deleteAlbum",ids:a,grsAjaxNonce:grsAjaxNonce};n.grsLoading=!0,i({method:"POST",url:grsAdminAjax,data:jQuery.param(e),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(e){l.log(e),n.grsLoading=!1;var r=e.data;if(void 0===r.error){void 0!==s.grsSelectedAlbum&&-1!==jQuery.inArray(s.grsSelectedAlbum.id,a)&&(s.grsSelectedAlbum={}),l.log(s.grsAlbums),l.log(a);for(var o=0;o<a.length;o++)for(var t=0;t<s.grsAlbums.length;t++)s.grsAlbums[t].id==a[o]&&s.grsAlbums.splice(t,1);for(o=0;o<a.length;o++)s.delAlbsContsFromPrnt(a[o],"alb");n.grsMassage=s.getTrans("text_059"),n.grsMassageMood="success"}else n.grsMassage=(r.error="")?s.getTrans("text_043"):r.error,n.grsMassageMood="error";n.massage()},function(e){return l.log("errr"),$q.reject(e)})}},s.grsAddGalleryForAlbum=function(e){s.grsAddContentForAlbum("gal",s.grsGalleriesForAlb[e])},s.grsAddAlbumForAlbum=function(e){s.grsAddContentForAlbum("alb",s.grsAlbums[e])},s.grsAddContentForAlbum=function(t,a){var n=angular.element(jQuery(".grsGallHeader")).scope();if(n.grsLoading)n.wmassage();else if("gal"==t||"alb"==t){var e={action:"grsGalleryAjax",grsAction:"addContentForAlbum",albId:s.grsSelectedAlbum.id,type:t,contentId:a.id,grsAjaxNonce:grsAjaxNonce};n.grsLoading=!0,i({method:"POST",url:grsAdminAjax,data:jQuery.param(e),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(e){n.grsLoading=!1;var r=e.data;if(void 0===r.error){var o={};o.albId=s.grsSelectedAlbum.id,o.type=t,o.contentId=a.id,o.id=r.success,o.description=a.description,o.title=a.title,o.prevImgName=a.prevImgName,o.prevImgPath=a.prevImgPath,o.prevImgType=a.prevImgType,s.grsSelectedAlbum.content.push(o),s.grsAlbAction="addAlbContent",s.grsAlbums=angular.copy(s.grsAlbums),n.grsMassage=s.getTrans("text_057"),n.grsMassageMood="success"}else n.grsMassage=r.error,n.grsMassageMood="error";n.massage()},function(e){return l.log("errr"),$q.reject(e)})}else l.log("error, undefined type")},s.grsDeleteAlbumContent=function(o){var t=angular.element(jQuery(".grsGallHeader")).scope();if(t.grsLoading)t.wmassage();else{var e={action:"grsGalleryAjax",grsAction:"deleteContentFromAlbum",id:s.grsSelectedAlbum.content[o].id,grsAjaxNonce:grsAjaxNonce};t.grsLoading=!0,i({method:"POST",url:grsAdminAjax,data:jQuery.param(e),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(e){t.grsLoading=!1;var r=e.data;void 0===r.error?(s.grsSelectedAlbum.content.splice(o,1),t.grsMassage=s.getTrans("successfully deleted"),t.grsMassageMood="success"):(t.grsMassage=(r.error="")?s.getTrans("text_043"):r.error,t.grsMassageMood="error"),t.massage()},function(e){return l.log("errr"),$q.reject(e)})}},s.delAlbsContsFromPrnt=function(e,r){for(var o=0;o<s.grsAlbums.length;o++)for(var t=0;t<s.grsAlbums[o].content.length;t++)s.grsAlbums[o].content[t].contentId==e&&s.grsAlbums[o].content[t].type==r&&s.grsAlbums[o].content.splice(t,1);s.grsAlbAction="deleteAlbum",s.grsAlbums=angular.copy(s.grsAlbums)},s.updateAlbsContents=function(e,r,o){for(var t=0;t<s.grsAlbums.length;t++)for(var a=0;a<s.grsAlbums[t].content.length;a++)s.grsAlbums[t].content[a].contentId==e&&s.grsAlbums[t].content[a].type==o&&(s.grsAlbums[t].content[a].title=r,s.grsSelectedAlbum&&s.grsAlbums[t].id==s.grsSelectedAlbum.id&&(s.grsSelectedAlbum.content[a].title=r));s.grsAlbums=angular.copy(s.grsAlbums)},s.activeAPw=function(){if(s.selAlbExists()){var e=angular.element(jQuery(".grsGallUpl")).scope(),r=angular.element(jQuery(".grsGallHeader")).scope();e.options.show||r.selectTab("Upl"),e.options.addAction="addPwAIm",e.options.addImages=!1,e.options.addImageTitle=s.getTrans("text_060")}},s.selAlbExists=function(){if(void 0!==s.grsSelectedAlbum)return!0;var e=angular.element(jQuery(".grsGallHeader")).scope();return e.grsMassage=s.getTrans("Select album"),e.grsMassageMood="error",e.massage(),!1},s.addPvIm=function(e,r,o){for(var t=0;t<s.grsAlbums.length;t++)if(s.grsAlbums[t].id==s.grsSelectedAlbum.id){s.grsSelectedAlbum.prevImgName=r,s.grsSelectedAlbum.prevImgPath=e,s.grsSelectedAlbum.prevImgType=o,s.grsSelectedAlbum.pvAlbIm=l.uploaderUrl+e+"thumbnail/"+r+o,s.grsSelectedAlbum.hidePvIm=!0,s.grsAlbums[t]=s.grsSelectedAlbum;break}},s.getPrevImg=function(e){var r=s.pageination;if(void 0!==r.pagedItems[r.currentPage]&&void 0!==r.pagedItems[r.currentPage][e]){var o=r.pagedItems[r.currentPage][e];return("grsnopv"==o.prevImgName?l.imagesDir:l.uploaderUrl)+o.prevImgPath+"thumbnail/"+o.prevImgName+o.prevImgType}},s.getTrans=l.getTrans}}}]),grsApp.directive("grsSettings",["$filter","$http","GrsAdminService",function(e,t,a){return{restrict:"E",transclude:!0,scope:!1,templateUrl:a.getViewsTemplateUrl("grsSettings"),link:function(n,e,r){n.data={},n.config=grsConfig,n.checkTDis=function(){return!n.config.comments},n.checkFilmDis=function(){return!n.config.filmstrip},n.checkEDis=function(){return!n.config.effects},n.getSettings=function(){var o=angular.element(jQuery(".grsGallHeader")).scope(),e={action:"grsGalleryAjax",grsAction:"getSettings",grsAjaxNonce:grsAjaxNonce};o.grsLoading=!0,t({method:"POST",url:grsAdminAjax,data:jQuery.param(e),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(e){a.log(e),o.grsLoading=!1;var r=e.data;void 0===r.error?n.data=r.success:(o.grsMassage=""==r.error?n.getTrans("text_061"):r.error,o.grsMassageMood="error",o.massage())},function(e){return a.log("errr"),o.grsLoading=!1,o.grsMassage=n.getTrans("text_061"),o.grsMassageMood="error",o.massage(!1),$q.reject(e)})},n.getSettings(),n.saveSett=function(){var o=angular.element(jQuery(".grsGallHeader")).scope();if(o.grsLoading)o.wmassage();else{var e={action:"grsGalleryAjax",grsAction:"saveSettings",settings:n.data.settings,grsAjaxNonce:grsAjaxNonce};o.grsLoading=!0,t({method:"POST",url:grsAdminAjax,data:jQuery.param(e),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(e){o.grsLoading=!1;var r=e.data;a.log(e),void 0===r.error?(o.grsMassage=n.getTrans("text_062"),o.grsMassageMood="success"):(o.grsMassage=""==r.error?n.getTrans("text_043"):r.error,o.grsMassageMood="error"),o.massage()},function(e){return a.log("errr"),$q.reject(e)})}},n.uninstallPr=function(e,r){void 0!==e&&e.stopPropagation();var o=angular.element(jQuery(".grsGallConfirmMC")).scope(),t=jQuery(e.target).offset().left-jQuery(".grsGallFCont").offset().left,a=jQuery(e.target).offset().top-jQuery(".grsGallFCont").offset().top;o.options.left=t-209,o.options.width="209px",o.options.top=a+30,o.options.actCnt=".grsGallContent",o.options.grsConMess=n.getTrans("text_015"),o.options.grsConMessCont="_limb_gallery_galleries, _limb_gallery_galleriescontent, _limb_gallery_settings, _limb_gallery_themes, _limb_gallery_comments, _limb_gallery_albumscontent, _limb_gallery_albums, _limb_gallery_shortcodes",o.options.grsConMessFoot=n.getTrans("text_012"),o.options.br=!0,o.options.actF="uninstall",o.options.actP.push(""),o.options.show=!0},n.uninstall=function(){var o=angular.element(jQuery(".grsGallHeader")).scope();if(o.grsLoading)o.wmassage();else{var e={action:"grsGalleryAjax",grsAction:"uninstall",grsAjaxNonce:grsAjaxNonce};o.grsLoading=!0,t({method:"POST",url:grsAdminAjax,data:jQuery.param(e),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(e){o.grsLoading=!1;var r=e.data;a.log(e),void 0!==r.success?o.grsMassage=1==r.success?n.getTrans("Plugin uninstalled"):r.success:o.grsMassage=""==r.error?n.getTrans("text_043"):r.error,o.grsMassageMood="error",o.massage()},function(e){return a.log("errr"),$q.reject(e)})}},n.getTrans=a.getTrans}}}]),grsApp.directive("grsPageNav",["$filter","GrsAdminService",function(o,e){return{restrict:"E",transclude:!0,scope:{pageInation:"="},templateUrl:e.getViewsTemplateUrl("grsPageNav"),link:function(a,e,r){a.order="id",a.reverse=!0;a.pageInation.search=function(e){angular.isUndefined(e)||(a.query=e),a.pageInation.filteredItems=o("filter")(a.pageInation.items,function(e){for(var r in e.id=parseInt(e.id),e)if("title"==r&&(o=e[r],!(t=a.query)||-1!==o.toLowerCase().indexOf(t.toLowerCase())))return!0;var o,t;return!1}),a.pageInation.filteredItems=o("orderBy")(a.pageInation.filteredItems,a.order,a.reverse),a.pageInation.groupToPages(),a.pageInation.firstPage()},a.pageInation.groupToPages=function(){a.pageInation.pagedItems=[];for(var e=0;e<a.pageInation.filteredItems.length;e++)e%a.pageInation.itemsPerPage==0?a.pageInation.pagedItems[Math.floor(e/a.pageInation.itemsPerPage)]=[a.pageInation.filteredItems[e]]:a.pageInation.pagedItems[Math.floor(e/a.pageInation.itemsPerPage)].push(a.pageInation.filteredItems[e])},a.pageInation.range=function(e,r){var o=[];r||(r=e,e=0);for(var t=e;t<r;t++)o.push(t);return o},a.pageInation.prevPage=function(e){void 0!==e&&e.stopPropagation(),0<a.pageInation.currentPage&&a.pageInation.currentPage--},a.pageInation.nextPage=function(e){void 0!==e&&e.stopPropagation(),a.pageInation.currentPage<a.pageInation.pagedItems.length-1&&a.pageInation.currentPage++},a.pageInation.lastPage=function(e){void 0!==e&&e.stopPropagation(),a.pageInation.currentPage<a.pageInation.pagedItems.length-1&&(a.pageInation.currentPage=a.pageInation.pagedItems.length-1)},a.pageInation.firstPage=function(e){void 0!==e&&e.stopPropagation(),0<a.pageInation.currentPage&&(a.pageInation.currentPage=0)},a.setPage=function(e){void 0!==e&&e.stopPropagation(),a.pageInation.currentPage=this.n},a.pageInation.search()}}}]),grsApp.controller("grsUploader",["$scope","$filter","$log","GrsAdminService",function(e,r,o,t){}]),grsApp.directive("grsUploader",["$filter","$http","$timeout","GrsAdminService",function(r,P,i,w){return{restrict:"E",transclude:!0,scope:!1,templateUrl:w.getViewsTemplateUrl("grsUploader"),link:function(j,c,e){j.sortingOrder="id",j.reverse=!1,j.filteredItems=[],j.groupedItems=[],j.pageSize=5,j.itemsPerPage=j.pageSize,j.pagedItems=[],j.currentPage=0,j.curentDirIndex=0,j.parentDirIndex=-1,j.mainItems=[],j.dirsData=[],j.items=[],j.itemsLength=function(){return j.items.length},j.options={show:!1,addImage:!1,addImages:!1,delImages:!1,addAction:"",addImageTitle:"Add",activeTab:""},j.activeTab=function(e){switch(e){case"Gall":j.options.addImage=!0,j.options.addImages=!0,j.options.addAction="addImages",j.options.activeTab="Gall";break;case"Alb":j.options.addImage=!0,j.options.addImages=!1,j.options.addAction="addPwAIm",j.options.addImageTitle=j.getTrans("text_060"),j.options.activeTab="Alb";break;case"Theme":j.options.addImage=!1,j.options.addImages=!1,j.options.addAction="",j.options.activeTab="Theme";case"Sett":j.options.addImage=!1,j.options.addImages=!1,j.options.addAction="",j.options.activeTab="Sett"}},j.$watch("currentPage",function(){j.unSelectAll()}),j.closeUpl=function(){j.options.show=!1},j.dirs=[],j.dirs.push({dirname:"limb-gallery",dirindex:0}),j.getItems=function(){var o=angular.element(jQuery(".grsGallHeader")).scope(),e={action:"grsGalleryAjax",grsAction:"getUploderItems",grsAjaxNonce:grsAjaxNonce};o.grsLoading=!0,P({method:"POST",url:grsAdminAjax,data:jQuery.param(e),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(e){o.grsLoading=!1;var r=e.data;angular.isUndefined(r.error)?(j.dirsData=r.success,j.changeDir(0)):(o.grsMassage=""===r.error?j.getTrans("text_063"):r.error,o.grsMassageMood="error",o.massage())},function(e){return w.log("errr"),o.grsLoading=!1,o.grsMassage=j.getTrans("text_063"),o.grsMassageMood="error",o.massage(!1),$q.reject(e)})},j.getItems(),j.upload=function(e){e.preventDefault(),c.find("#upload #grsUpload").click()},j.uplLsrc=function(){return w.imagesDir+"admin/ring-alt-u.svg"},j.uploadInProgress=function(e){if(angular.isUndefined(j.pagedItems[j.currentPage]))return!1;for(var r=0;r<j.pagedItems[j.currentPage].length;r++)if(!angular.isUndefined(j.pagedItems[j.currentPage][r].canAdd)&&!j.pagedItems[j.currentPage][r].canAdd)return!0;return!1},j.changeDir=function(e,r){if(j.uploadInProgress()){var o=angular.element(jQuery(".grsGallHeader")).scope();return o.grsMassage=j.getTrans("text_064"),o.grsMassageMood="error",void o.massage()}if(angular.isUndefined(r)||(r.stopPropagation(),r.preventDefault()),-1!=e&&""!==e){j.unSelectAll();for(var t=0;t<j.dirsData.length;t++)if(j.dirsData[t].curentDirIndex==e){var a=j.dirsData[t];j.items=a.items;break}j.parentDirIndex=a.parentDirIndex,j.curentDirIndex=e,j.parentDirPath=a.path;var n=j.parentDirPath.split("/");n=n[n.length-2];for(var s=0,i=[],l=0;l<j.dirs.length;l++)parseInt(j.dirs[l].dirindex)>parseInt(e)?i.push(j.dirs[l].dirindex):parseInt(j.dirs[l].dirindex)<parseInt(e)&&s++;for(var g=0;g<i.length;g++)for(t=0;t<j.dirs.length;t++)if(j.dirs[t].dirindex==i[g]){j.dirs.splice(t,1);break}s==l&&j.dirs.push({dirname:n,dirindex:e}),j.search()}},j.back=function(){j.changeDir(j.parentDirIndex)},j.changeMode=function(e){if(-1!=j.options.modes.indexOf(e)){for(var r=0;r<j.buttons.header.length;r++){var o=j.buttons.header[r].activeIn.indexOf(e);j.buttons.header[r].printC=-1!=o?j.buttons.header[r].activeC:j.buttons.header[r].deActiveC,j.buttons.header[r].active=-1!=o}j.options.activeMode=e}else w.log("no such mode")},j.addItem=function(e,r,o,t,a,n,s){n&&j.dirsData.push({curentDirIndex:a,parentDirIndex:j.curentDirIndex,path:j.parentDirPath+r+"/",items:[]}),j.items.splice(0,0,{key:e,name:r,dirPath:o,path:t,dirIndex:a,isDir:n,ext:s,canAdd:!!n}),j.search(),j.pageSize++,j.itemsPerPage=j.pageSize,j.firstPage()},j.addFolder=function(e){e.preventDefault();var t=angular.element(jQuery(".grsGallHeader")).scope();if(t.grsLoading)t.wmassage();else{var r={action:"grsGalleryAjax",grsAction:"addFolderInUploader",parentDirPath:j.parentDirPath,_method:"ADDFOLDER",grsAjaxNonce:grsAjaxNonce};key=j.itemsLength(),path=w.imagesDir+"admin/folder.png",dirIndex=j.dirsData.length,isDir=!0,t.grsLoading=!0,P({method:"POST",url:grsAdminAjax,data:jQuery.param(r),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(e){w.log(e),t.grsLoading=!1;var r=e.data,o=Object.keys(r)[0];void 0===r.error&&r[o]?(j.addItem(key,o,j.parentDirPath+o,path,dirIndex,isDir,""),t.grsMassage=j.getTrans("text_065"),t.grsMassageMood="success"):(t.grsMassage=""==r.error?j.getTrans("text_043"):r.error,t.grsMassageMood="error"),t.massage()},function(e){return w.log("errr"),$q.reject(e)})}},j.select=function(e,r){r.preventDefault(),r.stopPropagation();var o=j.pagedItems[j.currentPage][e];o.select=!o.select},j.isAllSelected=function(){return void 0!==j.pagedItems[j.currentPage]&&j.pagedItems[j.currentPage].every(function(e){return e.select})},j.isSingleSelExist=function(){if(void 0!==j.pagedItems[j.currentPage])for(var e=0;e<j.pagedItems[j.currentPage].length;e++)if(j.pagedItems[j.currentPage][e].select)return!0;return!1},j.isSingleImgSelExist=function(){if(void 0!==j.pagedItems[j.currentPage])for(var e=0;e<j.pagedItems[j.currentPage].length;e++)if(j.pagedItems[j.currentPage][e].select&&!j.pagedItems[j.currentPage][e].isDir)return!0;return!1},j.checkAddImgC=function(e){return j.options.addImages&&j.isSingleImgSelExist()},j.selectAll=function(e){var r=!j.isAllSelected();angular.forEach(j.pagedItems[j.currentPage],function(e){e.select=r})},j.unSelectAll=function(){angular.forEach(j.pagedItems[j.currentPage],function(e){e.select=!1})},j.grsDeleteUpImgPr=function(e,r){void 0!==e&&e.stopPropagation();var o=angular.element(jQuery(".grsGallConfirmMC")).scope(),t=jQuery(e.target).offset().left-jQuery(".grsGallFCont").offset().left,a=jQuery(e.target).offset().top-jQuery(".grsGallFCont").offset().top;if(o.options.left=t,o.options.top=a+25,o.options.actCnt=".grsGallUpl","grsGallUplImgD"==e.target.className)o.options.grsConMess=j.getTrans("text_046"),o.options.grsConIt=j.pagedItems[j.currentPage][r].name,o.options.grsConTp=j.pagedItems[j.currentPage][r].isDir?j.getTrans("text_066"):j.getTrans("text_067"),o.options.actF="deleteImg",o.options.actP.push(r);else{if(!j.isSingleSelExist()){var n=angular.element(jQuery(".grsGallHeader")).scope();return n.grsMassage=j.getTrans("text_068"),n.grsMassageMood="success",void n.massage()}o.options.grsConMess=j.getTrans("text_010"),o.options.actF="deleteImgs",o.options.actP.push("")}o.options.show=!0},j.deleteImg=function(o){var t=angular.element(jQuery(".grsGallHeader")).scope();if(t.grsLoading)t.wmassage();else{var e=j.pagedItems[j.currentPage][o],a=j.itemsPerPage*j.currentPage+parseInt(o);grsAction="delItemsFromUploader",files=[],files[0]=e.name+(e.isDir?"":e.ext);var r={action:"grsGalleryAjax",grsAction:grsAction,_method:"DELETE",parentDirPath:j.parentDirPath,files:files,grsAjaxNonce:grsAjaxNonce};t.grsLoading=!0,P({method:"POST",url:grsAdminAjax,data:jQuery.param(r),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(e){t.grsLoading=!1;var r=e.data;w.log(e),void 0===r.error?(j.deleteItemsInContent(r),j.pagedItems[j.currentPage][o].delete=!0,i(function(){j.items.splice(a,1),j.search()},500),t.grsMassage=j.getTrans("text_069"),t.grsMassageMood="success"):(t.grsMassage=r.error,t.grsMassageMood="error"),t.massage()},function(e){return w.log("errr"),$q.reject(e)})}},j.deleteImgs=function(){var t=angular.element(jQuery(".grsGallHeader")).scope();if(t.grsLoading)t.wmassage();else{var o=[],a=[],n=[];angular.forEach(j.pagedItems[j.currentPage],function(e){if(e.select){var r=e.name+(e.isDir?"":e.ext);o.push(r),a.push(e.name),n.push(e)}});var e={action:"grsGalleryAjax",grsAction:"delItemsFromUploader",_method:"DELETE",parentDirPath:j.parentDirPath,files:o,grsAjaxNonce:grsAjaxNonce};t.grsLoading=!0,P({method:"POST",url:grsAdminAjax,data:jQuery.param(e),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(e){t.grsLoading=!1;var r=e.data;if(w.log(e),void 0===r.error){j.deleteItemsInContent(r);for(var o=0;o<n.length;o++)n[o].delete=!0;i(function(){for(var e=0;e<a.length;e++)for(var r=0;r<j.items.length;r++)j.items[r].name==a[e]&&j.items.splice(r,1);j.search()},500),t.grsMassage=j.getTrans("text_048"),t.grsMassageMood="success"}else t.grsMassage=r.error,t.grsMassageMood="error";t.massage()},function(e){return w.log("errr"),$q.reject(e)})}},j.deleteItemsInContent=function(e){var r=angular.element(jQuery(".grsGallContent")).scope();if(0<e.length){for(var o=0;o<e.length;o++){for(var t=0;t<r.galleriesData.length;t++){for(var a=0;a<r.galleriesData[t].images.length;a++){var n=r.galleriesData[t].images[a];void 0!==e[o].name&&n.name==e[o].name&&n.path==e[o].path&&e[o].success&&r.galleriesData[t].images.splice(a,1)}void 0!==e[o].name&&r.galleriesData[t].prevImgName==e[o].name&&r.galleriesData[t].prevImgPath==e[o].path&&e[o].success&&(r.galleriesData[t].prevImgName="grsnopv",r.galleriesData[t].prevImgPath="",r.galleriesData[t].prevImgType=".png"),void 0!==r.selGall&&r.selGall.id==r.galleriesData[t].id&&r.changeGallery(r.galleriesData[t].id)}for(t=0;t<r.grsAlbums.length;t++)void 0!==e[o].name&&r.grsAlbums[t].prevImgName==e[o].name&&r.grsAlbums[t].prevImgPath==e[o].path&&e[o].success&&(r.grsAlbums[t].prevImgName="grsnopv",r.grsAlbums[t].prevImgPath="",r.grsAlbums[t].prevImgType=".png"),void 0!==r.grsSelectedAlbum&&r.grsSelectedAlbum.id==r.grsAlbums[t].id&&r.grsChangeAlbum(t)}r.$$phase||r.$apply()}},j.showIn=function(e,r){j.pagedItems[j.currentPage][e].rename=!0,j.pagedItems[j.currentPage][e].lastName=j.pagedItems[j.currentPage][e].name,r.preventDefault(),r.stopPropagation()},j.rename=function(e){var o=angular.element(jQuery(".grsGallHeader")).scope(),r=!1,t=j.pagedItems[j.currentPage][e];if(o.grsLoading)o.wmassage();else{if(-1!=t.name.indexOf('"')?(o.grsMassage=j.getTrans("text_006"),r=!0):""==t.name&&(o.grsMassage=j.getTrans("text_007"),r=!0),r)return t.name=t.lastName,o.grsMassageMood="error",void o.massage();j.itemsPerPage,j.currentPage,parseInt(e);grsAction="renameItemInUploader",data={action:"grsGalleryAjax",grsAction:grsAction,parentDirPath:j.parentDirPath,_method:"RENAME",itemNewName:t.name+t.ext,itemName:t.lastName+t.ext,grsAjaxNonce:grsAjaxNonce},o.grsLoading=!0,P({method:"POST",url:grsAdminAjax,data:jQuery.param(data),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(e){o.grsLoading=!1;var r=e.data;void 0!==r.success&&r.success?(j.renameItem(r.old_name,r.new_name),t.rename=!1,o.grsMassage=j.getTrans("text_070"),o.grsMassageMood="success"):(o.grsMassage=r.error,o.grsMassageMood="error",t.name=t.lastName,t.rename=!1),o.massage()},function(e){return w.log("errr"),$q.reject(e)})}},j.renameItem=function(e,c){for(var d=[],r=0;r<j.items.length;r++)if(e===j.items[r].lastName){if(j.items[r].name=c,j.items[r].isDir){for(var o=j.items[r].dirIndex,t=0;t<j.dirsData.length;t++)if(j.dirsData[t].curentDirIndex==o){(a=(a=j.dirsData[t].path).split("/"))[a.length-2]=c,j.dirsData[t].path=a.join("/");break}function u(e,r){r+=1;for(var o=0;o<j.dirsData.length;o++)if(j.dirsData[o].curentDirIndex==e)for(var t=0;t<j.dirsData[o].items.length;t++)if(j.dirsData[o].items[t].isDir){curDirIndex=j.dirsData[o].items[t].dirIndex;for(var a=0;a<j.dirsData.length;a++)if(j.dirsData[a].curentDirIndex==curDirIndex){(n=(n=j.dirsData[a].path).split("/"))[n.length-r]=c,j.dirsData[a].path=n.join("/"),u(curDirIndex,r);break}}else{var n,s=(n=j.dirsData[o].items[t].path).split(w.uploaderUrl+j.parentDirPath),i=j.dirsData[o].items[t].name+j.dirsData[o].items[t].ext,l={};w.log(n),w.log(j.parentDirPath),(n=n.split("/"))[n.length-r]=c,j.dirsData[o].items[t].path=n.join("/");var g=n.join("/").split(w.uploaderUrl+j.parentDirPath);l.name=j.dirsData[o].items[t].name,l.oldPath=s[1].replace("/thumbnail","").replace(i,""),l.newPath=g[1].replace("/thumbnail","").replace(i,""),d.push(l)}}u(o,2)}else{var a=j.items[r].path,n={};n.newName=c,n.oldName=j.items[r].lastName,n.path=j.parentDirPath,d.push(n),(a=a.split("/"))[a.length-1]=c,j.items[r].path=a.join("/")+j.items[r].ext}j.renameItemsInContent(d);break}},j.renameItemsInContent=function(e){var r=angular.element(jQuery(".grsGallContent")).scope();if(0<e.length){for(var o=0;o<e.length;o++){for(var t=0;t<r.galleriesData.length;t++){for(var a=0;a<r.galleriesData[t].images.length;a++){var n=r.galleriesData[t].images[a];void 0!==e[o].newName?n.name==e[o].oldName&&n.path==e[o].path&&(n.name=e[o].newName):void 0!==e[o].newPath&&n.path==e[o].oldPath&&n.name==e[o].name&&(n.path=e[o].newPath)}void 0!==e[o].newName?r.galleriesData[t].prevImgName==e[o].oldName&&r.galleriesData[t].prevImgPath==e[o].path&&(r.galleriesData[t].prevImgName=e[o].newName):void 0!==e[o].newPath&&r.galleriesData[t].prevImgPath==e[o].oldPath&&r.galleriesData[t].prevImgName==e[o].name&&(r.galleriesData[t].prevImgPath=e[o].newPath)}for(t=0;t<r.grsAlbums.length;t++)void 0!==e[o].newName?r.grsAlbums[t].prevImgName==e[o].oldName&&r.grsAlbums[t].prevImgPath==e[o].path&&(r.grsAlbums[t].prevImgName=e[o].newName):void 0!==e[o].newPath&&r.grsAlbums[t].prevImgPath==e[o].oldPath&&r.grsAlbums[t].prevImgName==e[o].name&&(r.grsAlbums[t].prevImgPath=e[o].newPath)}r.$$phase||r.$apply()}},j.addImage=function(e,r){if(r.stopPropagation(),r.preventDefault(),j.options.addImage){var o=j.pagedItems[j.currentPage][e];if(void 0!==o.canAdd&&!o.canAdd){var t=angular.element(jQuery(".grsGallHeader")).scope();return t.grsMassage=j.getTrans("text_064"),t.grsMassageMood="error",void t.massage()}o.select=!1;var a=[],n=[],s=[],i=[],l=document.querySelector("#grsImageKey"+o.key+" .grsGallUplImg"),g={nW:l.naturalWidth,nH:l.naturalHeight};a.push(o.name),n.push(o.ext),s.push(c.find("#grsImageKey"+o.key)),i.push(g),j.addSave(a,n,s,i)}},j.addImages=function(){var e=angular.element(jQuery(".grsGallHeader")).scope();if(!j.isSingleImgSelExist())return e.grsMassage=j.getTrans("text_071"),e.grsMassageMood="success",void e.massage();if(!j.options.addImages)return e.grsMassage=j.getTrans("text_001"),e.grsMassageMood="success",void e.massage();var r=[],o=[],t=[],a=!1,n=!1,s=[];if(angular.forEach(j.pagedItems[j.currentPage],function(e){if(e.select){if(e.isDir)return void(a=!0);if(void 0!==e.canAdd&&!e.canAdd)return void(n=!0);e.select=!1,imDomS=document.querySelector("#grsImageKey"+e.key+" .grsGallUplImg"),nRob={nW:imDomS.naturalWidth,nH:imDomS.naturalHeight},r.push(e.name),o.push(e.ext),t.push(c.find("#grsImageKey"+e.key)),s.push(nRob)}}),a&&(e.grsMassage=j.getTrans("text_072"),e.grsMassageMood="success",e.massage()),n)return(e=angular.element(jQuery(".grsGallHeader")).scope()).grsMassage=j.getTrans("text_064"),e.grsMassageMood="error",void e.massage();0<r.length&&j.addSave(r,o,t,s)},j.addSave=function(e,r,o,t){var a=angular.element(jQuery(".grsGallHeader")).scope();if(a.grsLoading)a.wmassage();else{var n=[],s=[],i=[],l=jQuery(".grsGallContent"),g=angular.element(l).scope(),c=g.getMinOrder();l.removeClass("grsAnDur grsFadeIn"),grsAction=j.options.addAction;for(var d=0;d<e.length;d++){var u=e[d],m=r[d],p=o[d],f=t[d];switch(grsAction){case"addImages":grsId=g.selGall.id;var h=--c;if(i.push(h),g.selGall.imagesCount=g.selGall.imagesCount?parseInt(g.selGall.imagesCount)+1:1,s.push(g.selGall.imagesCount),g.addItem(u,u,"",j.parentDirPath,"",h,m,"","",g.selGall.imagesCount,null),grsGFImC=l.find(".grsGallCoGaImsC"),jQuery(".grsGallCoGaC").removeClass("grsAnDur grsSlideInRight"),1<f.nW/f.nH)var v=228<f.nW?228:f.nW,C=f.nH*v/f.nW;else C=166<f.nH?166:f.nH,v=f.nW*C/f.nH;var b=9+grsGFImC.offset().left+(228-v)/2-p.offset().left,y=0+grsGFImC.offset().top+(166-C)/2-p.offset().top;break;case"addGPvIm":if(grsId=g.selGall.id,g.addGPvIm(j.parentDirPath,u,m),jQuery(".grsGallCoGaC").removeClass("grsAnDur grsSlideInRight"),1<f.nW/f.nH)v=81<f.nW?81:f.nW,C=f.nH*v/f.nW;else C=81<f.nH?81:f.nH,v=f.nW*C/f.nH;b=l.find(".grsGallCoGaInPic").offset().left+(81-v)/2-p.offset().left,y=l.find(".grsGallCoGaInPic").offset().top+(81-C)/2-p.offset().top;break;case"addPwAIm":if(grsId=g.grsSelectedAlbum.id,g.addPvIm(j.parentDirPath,u,m),jQuery(".grsGallCoAlbC").removeClass("grsAnDur grsSlideInLeft"),1<f.nW/f.nH)v=81<f.nW?81:f.nW,C=f.nH*v/f.nW;else C=81<f.nH?81:f.nH,v=f.nW*C/f.nH;b=l.find(".grsGallCoAlbPic").offset().left+(81-v)/2-p.offset().left,y=l.find(".grsGallCoAlbPic").offset().top+(81-C)/2-p.offset().top}var T=p.find("img");n[d]=T.clone();var I=T.offset().left-p.offset().left,A=T.offset().top-p.offset().top;n[d].appendTo(p),n[d].attr("style","position: absolute;opacity: 0.3 !important;z-index: 100;width: "+T.width()+"px;height: "+T.height()+"px;left: "+I+"px;top: "+A+"px;"),n[d].animate({opacity:1,left:b,top:y,width:v,height:C},600,x(d)),B(n[d])}var k={action:"grsGalleryAjax",grsAction:grsAction,grsId:grsId,files:e,types:r,orders:i,parentDirPath:j.parentDirPath,grsAjaxNonce:grsAjaxNonce};a.grsLoading=!0,P({method:"POST",url:grsAdminAjax,data:jQuery.param(k),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(e){a.grsLoading=!1;var r=e.data;if("success"===Object.keys(r)[0]){switch(grsAction){case"addImages":a.grsMassage=j.getTrans("text_044"),g.addIdsToScopes(s,r.success);break;case"addGPvIm":j.options.addImage=!0,j.options.addImages=!0,j.options.addAction="addImages",j.options.addImageTitle="Add",a.grsMassage=j.getTrans("text_073");break;case"addPwAIm":a.grsMassage=j.getTrans("text_073")}a.grsMassageMood="success"}else a.grsMassage=r.error,a.grsMassageMood="error";a.massage()},function(e){return w.log("errr"),$q.reject(e)})}function x(r){return function(){switch(grsAction){case"addImages":for(var e=0;e<g.items.length;e++)g.items[e].key==s[r]&&(g.items[e].hide=!1,g.$apply());break;case"addGPvIm":g.selGall.hidePvIm=!1,g.$apply();break;case"addPwAIm":g.grsSelectedAlbum.hidePvIm=!1,g.$apply()}}}function B(e){setTimeout(function(){e.remove()},600)}},j.getItemByKey=function(e){for(var r=0;r<j.items.length;r++)if(j.items[r].key==e)return j.items[r]},j.removeItemByKey=function(e){for(var r=0;r<j.items.length;r++)j.items[r].key==e&&j.items.splice(r,1);j.search()},j.changeItemsPerPage=function(){j.pageSize=void 0===j.pageSize||null==j.pageSize?1:j.pageSize,j.itemsPerPage=j.pageSize,j.search()};j.search=function(){j.filteredItems=r("filter")(j.items,function(e){for(var r in e)if("name"==r&&(o=e[r],!(t=j.query)||-1!==o.toLowerCase().indexOf(t.toLowerCase())))return!0;var o,t;return!1}),j.currentPage=0,j.groupToPages()},j.groupToPages=function(){j.pagedItems=[];for(var e=0;e<j.filteredItems.length;e++)e%j.itemsPerPage==0?j.pagedItems[Math.floor(e/j.itemsPerPage)]=[j.filteredItems[e]]:j.pagedItems[Math.floor(e/j.itemsPerPage)].push(j.filteredItems[e])},j.range=function(e,r){var o=[];r||(r=e,e=0);for(var t=e;t<r;t++)o.push(t);return o},j.prevPage=function(){0<j.currentPage&&j.currentPage--},j.nextPage=function(){j.currentPage<j.pagedItems.length-1&&j.currentPage++},j.lastPage=function(){j.currentPage<j.pagedItems.length-1&&(j.currentPage=j.pagedItems.length-1)},j.firstPage=function(){0<j.currentPage&&(j.currentPage=0)},j.setPage=function(){j.currentPage=this.n},j.getTrans=w.getTrans,c.find("#upload").fileupload({dropZone:jQuery("#drop"),submit:function(e,r){r.formData={action:"grsGalleryAjax",grsAction:"addImageToUploader",parentDirPath:j.parentDirPath,grsAjaxNonce:grsAjaxNonce}},add:function(e,r){var o=j.itemsLength(),t=r.files[0].name,a=r.files[0].type,n=r.files[0].name.lastIndexOf(".");if("jpeg"===(a=a.split("/"))[1]){var s=r.files[0].name.slice(0,n);a=(s=r.files[0].name.split(s))[1]}else if("png"===a[1]){s=r.files[0].name.slice(0,n);a=(s=r.files[0].name.split(s))[1]}else{if("gif"!==a[1])return;s=r.files[0].name.slice(0,n);a=(s=r.files[0].name.split(s))[1]}t=t.slice(0,n);var i=w.uploaderUrl+j.parentDirPath+"thumbnail/"+t+a;j.addItem(o,t,"",i,"",!1,a),j.$$phase||j.$apply();var l=jQuery("#grsImageKey"+o),g=new FileReader;g.onload=function(e){l.find(".grsGallUplImg").attr("src",e.target.result),l.find(".grsGallUplImgLdSC > input").knob(),l.find(".grsGallUplImgLdSC > input").css("display","inline-block;")},g.readAsDataURL(r.files[0]),r.context=l;r.submit()},start:function(e){jQuery(".grsGallUplProgress").css("display","block")},progress:function(e,r){var o=parseInt(r.loaded/r.total*100,10);r.context.find("input").val(o).change()},stop:function(e){jQuery(".grsGallUplProgress").hide(),jQuery(".grsGallUplProgress .grsGallUplProgressB").css("width",0)},progressall:function(e,r){var o=parseInt(r.loaded/r.total*100,10)+"%";jQuery(".grsGallUplProgress .grsGallUplProgressB").css("width",o).text(o)},fail:function(e,r){r.context.addClass("error")},chunkfail:function(e,r){r.context.addClass("error")},done:function(e,r){var o=r.context.selector.split("grsImageKey"),t=Array.isArray(o)?o[1]:-1,a=JSON.parse(r.result),n=j.getItemByKey(t);if(0==a||void 0!==a.error){w.log(a);var s=angular.element(jQuery(".grsGallHeader")).scope();return void 0!==a.error&&(s.grsMassage=a.error),0==a&&(s.grsMassage=j.getTrans("text_002")),s.grsMassageMood="error",s.massage(),r.context.addClass("grsUplError"),i(function(){j.removeItemByKey(t)},4500),void r.context.find(".grsGallUplImgLdC").addClass("grsDisplayNone")}void 0!==a.files&&(n.name=a.files[0].name.slice(0,-n.ext.length),n.path=w.uploaderUrl+j.parentDirPath+"thumbnail/"+n.name+n.ext),n.canAdd=!0,r.context.addClass("grsUplCompl"),r.context.find(".grsGallUplImgLdC").addClass("grsDisplayNone"),r.context.find(".grsGallUplImgAcC").removeClass("grsDisplayNone"),r.context.find("img").css("opacity",1),r.context.find("img").attr("src",n.path),j.$$phase||j.$apply()},always:function(e,r){},url:grsAdminAjax}),jQuery(document).on("drop dragover",function(e){e.preventDefault()})}}}]),grsApp.controller("grsGallHeader",["$scope","$filter","$log","$http","$timeout","$window","GrsAdminService",function(n,e,r,s,o,t,i){n.items=[],n.action="",n.selGall={},n.query="",n.activeTab="",n.showGTs=!1,n.grsLoading=!1,n.galleriesDataIsLoaded=!1,n.grsMassageC=!1,n.grsMassage="",n.grsMassageMood="",n.mTimeOut={},n.config=grsConfig,n.wmassage=function(){n.grsMassage=n.getTrans("text_003"),n.grsMassageMood="error",n.massage()},n.massage=function(e,r){n.grsMassageC=!0,e=!!angular.isUndefined(e)||e,r=angular.isUndefined(r)?3e3:r,angular.isUndefined(n.mTimeOut.cont)||o.cancel(n.mTimeOut.cont),angular.isUndefined(n.mTimeOut.text)||o.cancel(n.mTimeOut.text),e&&(n.mTimeOut.cont=o(function(){n.grsMassageC=!1},r),n.mTimeOut.text=o(function(){n.grsMassage=""},r+2e3)),n.$$phase||n.$apply()},n.pageination={items:[],currentPage:0,itemsPerPage:4},n.clearSearchBar=function(e){e.stopPropagation(),n.query="",n.pageination.search(n.query)},n.$watch("items",function(){switch(n.pageination.items=angular.copy(n.items),void 0!==n.pageination.search&&n.pageination.search(),n.action){case"addItem":n.pageination.firstPage(),n.selectGallery(0);break;case"deleteItem":angular.isUndefined(n.pageination.pagedItems[n.pageination.currentPage])&&n.pageination.currentPage--}n.action=""}),n.getItems=function(){var e={action:"grsGalleryAjax",grsAction:"getGalleryTItems",grsAjaxNonce:grsAjaxNonce};n.grsLoading=!0,s({method:"POST",url:grsAdminAjax,data:jQuery.param(e),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(e){n.grsLoading=!1;var r=e.data;void 0===r.error?n.items=r.success:(n.grsMassage=""!=r.error?r.error:n.getTrans("text_074"),n.grsMassageMood="error",n.massage())},function(e){return i.log("errr"),n.grsLoading=!1,n.grsMassage=n.getTrans("text_074"),n.grsMassageMood="error",n.massage(!1),$q.reject(e)})},n.getItems(),n.selectGallery=function(e,r){angular.isUndefined(r)||r.stopPropagation();var o=n.pageination.pagedItems[n.pageination.currentPage][e],t=o.id,a=angular.element(jQuery(".grsGallContent")).scope();t&&(n.selectTab("Gall"),void 0!==n.selGall.id&&n.selGall.id==t||(n.showGTs=!1,n.selGall=o,a.changeGallery(t),grsActiveCont="Gall"))},n.addItem=function(e,r,o){n.items.push({title:e,description:r,id:o}),n.action="addItem",n.items=angular.copy(n.items)},n.updateItem=function(e){n.selGall.title=e,i.log(n.selGall);for(var r=n.items,o=0;o<r.length;o++)r[o].id==n.selGall.id&&(r[o].title=e);n.action="updateItem",n.items=angular.copy(n.items)},n.deleteGalleryPr=function(e,r){angular.isUndefined(r)||r.stopPropagation();var o=angular.element(jQuery(".grsGallConfirmMC")).scope(),t=jQuery(r.target).offset().left-jQuery(".grsGallFCont").offset().left,a=jQuery(r.target).offset().top-jQuery(".grsGallFCont").offset().top;o.options.show=!0,o.options.left=t,o.options.top=a+25,o.options.grsConMess=n.getTrans("text_046"),o.options.grsConIt=n.pageination.pagedItems[n.pageination.currentPage][e].title,o.options.grsConTp=n.getTrans("text_075"),o.options.actCnt=".grsGallHeader",o.options.actF="deleteGallery",o.options.actP.push(e)},n.deleteGallery=function(e){var o=n.pageination.pagedItems[n.pageination.currentPage][e].id,t=n.pageination.itemsPerPage*n.pageination.currentPage+e,a=angular.element(jQuery(".grsGallContent")).scope(),r={action:"grsGalleryAjax",grsAction:"delete",grsGallid:o,grsAjaxNonce:grsAjaxNonce};o&&(n.grsLoading=!0,s({method:"POST",url:grsAdminAjax,data:jQuery.param(r),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(e){i.log(e);var r=e.data;void 0===r.error?(a.deleteGallery(o),n.action="deleteItem",n.items.splice(t,1),n.items=angular.copy(n.items),n.grsMassage=n.getTrans("successfully deleted"),n.grsMassageMood="success"):(n.grsMassage=r.error,n.grsMassageMood="error"),n.massage(),n.grsLoading=!1},function(e){return i.log("errr"),$q.reject(e)}))},n.addGallery=function(){var e=angular.element(jQuery(".grsGallContent")).scope();grsActiveCont="Gall",n.selectTab("Gall"),e.changeGallery(0),e.grsSave()},n.showGTsCont=function(e){if(e.preventDefault(),e.stopPropagation(),n.grsLoading||!n.galleriesDataIsLoaded)return n.grsMassage=n.getTrans("text_076"),n.grsMassageMood="success",void n.massage();var r=n.items.length;0===r&&(n.grsMassage=n.getTrans("text_004"),n.grsMassageMood="success",n.massage()),n.showGTs=!(n.showGTs||0===r)},n.selectTab=function(e){var r=angular.element(jQuery(".grsGallContent")).scope(),o=angular.element(jQuery(".grsGallUpl")).scope();if("Upl"!==e){if(!n.checkConf(e))return;n.activeTab=e,grsActiveCont=e,r.show=!0,r.showContPart=e,o.activeTab(e)}else o.options.show=!0},n.disTheme=function(){return!n.config.themes},n.shProF=function(){var e=!1;for(f in n.config)if(!n.config[f]){e=!0;break}return e},n.checkConf=function(e){return!("Theme"===e&&!n.config.themes)||(n.grsMassage=n.getTrans("text_005"),n.grsMassageMood="success",n.massage(),!1)},n.checkTooltip=function(){i.setTooltip()},n.$on("winclick::winclick",function(){n.showGTs&&(n.showGTs=!1,n.$$phase||n.$apply())}),n.getTrans=i.getTrans}]),grsApp.controller("grsConfirmM",["$scope","$filter","$log","$http","$timeout","GrsAdminService",function(o,e,r,t,a,n){o.options={show:!1,grsConMess:"",grsConIt:"",grsConTp:"",left:0,top:0,actCnt:"",actF:"",actP:[]},o.answer=function(e,r){(r.stopPropagation(),e)&&angular.element(jQuery(o.options.actCnt)).scope()[o.options.actF](o.options.actP[0]);o.options={show:!1,grsConMess:"",grsConIt:"",grsConTp:"",left:0,top:0,actCnt:"",actF:"",actP:[]},n.log(o.options)}}]);